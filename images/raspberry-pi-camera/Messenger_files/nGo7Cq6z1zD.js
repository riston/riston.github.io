if (self.CavalryLogger) { CavalryLogger.start_js(["IAnYY"]); }

__d("TilesMapTheme",[],(function a(b,c,d,e,f,g){f.exports={DEFAULT:"default",CROWDSOURCING_OSM:"crowdsourcing_osm",CROWDSOURCING_PPM_DG:"crowdsourcing_ppm_dg",ROAD_MASK_OSM_EDITING:"road_mask_osm_editing",LIVE_MAPS:"live_maps",INDOOR_OSM:"indoor_osm",LIVE_MAPS_MIMIC:"live_maps_mimic"};}),null);
__d('GeoCoordinatesRecord',['immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('immutable').Record({latitude:undefined,longitude:undefined});h=babelHelpers.inherits(k,j);i=h&&h.prototype;function k(){h.apply(this,arguments);}f.exports=k;}),null);
__d("nearlyEqualNumbers",[],(function a(b,c,d,e,f,g){function h(i,j){if(i===j)return true;var k=Math.abs(i-j);if(k<Number.EPSILON)return true;var l=Math.abs(i),m=Math.abs(j);return k/(l+m)<Number.EPSILON;}f.exports=h;}),null);
__d('GeoCoordinates',['GeoCoordinatesRecord','nearlyEqualNumbers'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('GeoCoordinatesRecord'));i=h&&h.prototype;function j(k,l){i.constructor.call(this,{latitude:k,longitude:l});}j.prototype.nearlyEquals=function(k){return c('nearlyEqualNumbers')(this.latitude,k.latitude)&&c('nearlyEqualNumbers')(this.longitude,k.longitude);};f.exports=j;}),null);
__d('ElementResizeEmitter',['cx','invariant','DOM','EventListener','SubscriptionList','requestAnimationFrame'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=!!navigator.userAgent.match(/Trident/);j=babelHelpers.inherits(m,c('SubscriptionList'));k=j&&j.prototype;function m(n){getComputedStyle(n).position!=='static'||i(0);k.constructor.call(this,m.__setup,m.__teardown);this.$ElementResizeEmitter1=n;this.$ElementResizeEmitter2=false;}m.__setup=function(){var n=document.createElement('iframe');this.$ElementResizeEmitter3=n;if(l)n.src='javascript:void((function(){document.open();document.domain='+JSON.stringify(document.domain)+';document.close();})())';n.className="_3dtr";n.onload=this.$ElementResizeEmitter4.bind(this);this.$ElementResizeEmitter1.appendChild(n);};m.__teardown=function(){if(this.$ElementResizeEmitter3){if(this.$ElementResizeEmitter5!=undefined&&this.$ElementResizeEmitter3.document!==undefined)this.$ElementResizeEmitter5.remove();c('DOM').remove(this.$ElementResizeEmitter3);this.$ElementResizeEmitter3=undefined;}};m.prototype.$ElementResizeEmitter4=function(){this.$ElementResizeEmitter6();var n=void 0;try{n=this.$ElementResizeEmitter3.contentWindow;n.document;}catch(o){return;}this.$ElementResizeEmitter5=c('EventListener').listen(n,'resize',this.$ElementResizeEmitter6.bind(this));};m.prototype.$ElementResizeEmitter6=function(){if(this.$ElementResizeEmitter2)return;this.$ElementResizeEmitter2=true;c('requestAnimationFrame')(function(){this.fireCallbacks();this.$ElementResizeEmitter2=false;}.bind(this));};f.exports=m;}),null);
__d('forEachDifference',['forEachObject'],(function a(b,c,d,e,f,g){'use strict';function h(i,j,k){c('forEachObject')(i,function(l,m){if(Object.prototype.hasOwnProperty.call(j,m)){if(k.onBoth)k.onBoth(l,j[m],m);}else if(k.onLeft)k.onLeft(l,m);});c('forEachObject')(j,function(l,m){if(!Object.prototype.hasOwnProperty.call(i,m)&&k.onRight)k.onRight(l,m);});}f.exports=h;}),null);
__d('partitionObject',['forEachObject'],(function a(b,c,d,e,f,g){'use strict';function h(i,j,k){var l={},m={};c('forEachObject')(i,function(n,o){if(j.call(k,n,o,i)){l[o]=n;}else m[o]=n;});return [l,m];}f.exports=h;}),null);
__d('partitionObjectByKey',['partitionObject'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){return c('partitionObject')(i,function(k,l){return j.has(l);});}f.exports=h;}),null);
__d('LeafletLayer.react',['React','Set','areEqual','forEachDifference','forEachObject','partitionObjectByKey'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').Component);i=h&&h.prototype;function k(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=i.constructor).call.apply(n,[this].concat(q)),this.$LeafletLayer1=undefined,this.$LeafletLayer2=function(s){this.$LeafletLayer1=this.props.onCreateLayer(s);this.context.onAddLayer(this.$LeafletLayer1);}.bind(this),o;}k.mutateEventHandlers=function(n,o,p){if(!c('areEqual')(o,p))c('forEachDifference')(o||{},p||{},{onLeft:function q(r,s){n.on(s,r);},onRight:function q(r,s){n.off(s,r);},onBoth:function q(r,s,t){if(r!==s){n.off(t,s);n.on(t,r);}}});};k.addEventHandlers=function(n,o){if(o!=null)c('forEachObject')(o,function(p,q){n.on(q,p);});};k.prototype.componentDidMount=function(){this.$LeafletLayer2(m(this.props));};k.prototype.componentDidUpdate=function(n){var o=m(this.props),p=m(n);if(this.props.onUpdateLayer!==n.onUpdateLayer||!this.props.onUpdateLayer(this.$LeafletLayer1,o,p)){this.context.onRemoveLayer(this.$LeafletLayer1);this.$LeafletLayer2(o);}};k.prototype.componentWillUnmount=function(){this.context.onRemoveLayer(this.$LeafletLayer1);this.$LeafletLayer1=null;};k.prototype.render=function(){return null;};k.propTypes={onCreateLayer:j.func.isRequired,onUpdateLayer:j.func.isRequired};k.contextTypes={onAddLayer:j.func.isRequired,onRemoveLayer:j.func.isRequired};var l=new (c('Set'))(Object.keys(k.propTypes));function m(n){return c('partitionObjectByKey')(n,l)[1];}f.exports=k;}),null);
__d('LeafletMapLayer.react',['invariant','LeafletLayer.react','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.$LeafletMapLayer1=function(){var r=c('React').Children.only(this.props.children);this.$LeafletMapLayer3=r;return r.type.toLayer(r.props);}.bind(this),this.$LeafletMapLayer2=function(r,s,t){var u=c('React').Children.only(this.props.children);if(u.type!==this.$LeafletMapLayer3.type)return false;this.$LeafletMapLayer3=u;return u.type.mutate(r,s,t);}.bind(this),n;}l.prototype.componentDidMount=function(){var m=c('React').Children.only(this.props.children);m.type.mutate||h(0);m.type.toLayer||h(0);};l.prototype.render=function(){var m=c('React').Children.only(this.props.children);return c('React').createElement(c('LeafletLayer.react'),babelHelpers['extends']({},m.props,{onAddLayer:this.props.onAddLayer,onRemoveLayer:this.props.onRemoveLayer,onCreateLayer:this.$LeafletMapLayer1,onUpdateLayer:this.$LeafletMapLayer2}));};l.propTypes={onAddLayer:k.func.isRequired,onRemoveLayer:k.func.isRequired};f.exports=l;}),null);
__d('LeafletView',['invariant','GeoCoordinates','ImmutableObject','nearlyEqualNumbers'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;i=babelHelpers.inherits(k,c('ImmutableObject'));j=i&&i.prototype;function k(l){l||h(0);l.center instanceof c('GeoCoordinates')||h(0);typeof l.zoom==='number'||h(0);j.constructor.call(this,l);}k.prototype.nearlyEquals=function(l){return this.center.nearlyEquals(l.center)&&c('nearlyEqualNumbers')(this.zoom,l.zoom);};k.prototype.setZoom=function(l){return new k({center:this.center,zoom:l});};k.prototype.setCenter=function(l){return new k({center:l,zoom:this.zoom});};k.DEFAULT=new k({center:new (c('GeoCoordinates'))(0,0),zoom:0});f.exports=k;}),null);
__d("mod",[],(function a(b,c,d,e,f,g){function h(i,j){var k=i%j;if(k*j<0)k+=j;return k;}f.exports=h;}),null);
__d('LeafletUtils',['invariant','GeoCoordinates','LeafletView','leaflet','mod'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('leaflet').CRS.EPSG3857,j=360,k=j/2,l=c('leaflet').LatLng.DEG_TO_RAD,m=c('leaflet').LatLng.RAD_TO_DEG,n=c('leaflet').Projection.Mercator.R_MAJOR,o=2*Math.PI*n,p=new (c('leaflet').LatLngBounds)(new (c('leaflet').LatLng)(-j/4,-j/2),new (c('leaflet').LatLng)(j/4,j/2));function q(s){var t=s.zoomRange;Array.isArray(t)&&t.length===2||h(0);return t;}var r={WHOLE_WORLD_BOUNDS:p,FULL_CIRCLE_DEG:j,fromLatLng:function s(t){return new (c('GeoCoordinates'))(t.lat,t.lng);},normalizedBounds:function s(t,u){var v=r.wrapLongitude(t.lng);u=c('leaflet').latLng(u.lat,u.lng+v-t.lng);t=c('leaflet').latLng(t.lat,v);return c('leaflet').latLngBounds(t,u);},fitBounds:function s(t,u,v){var w=v.crs||i,x=q(v),y=r.getBoundsZoom(t,u,{zoomRange:x,crs:w});if(y==null)y=x[0];var z=w.latLngToPoint(t.getSouthWest(),y),aa=w.latLngToPoint(t.getNorthEast(),y),ba=r.fromLatLng(w.pointToLatLng(z.add(aa).divideBy(2),y));return new (c('LeafletView'))({center:ba,zoom:y});},getBoundsZoom:function s(t,u,v){var w=v.crs||i,x=q(v),y=c('leaflet').point(u.width,u.height),z=t.getNorthWest(),aa=t.getSouthEast(),ba=x[0]-1;for(;ba<=x[1];++ba){var ca=w.latLngToPoint(aa,ba+1),da=w.latLngToPoint(z,ba+1),ea=ca.subtract(da).floor();if(!y.contains(ea))break;}if(ba<x[0])return null;if(ba<=x[1])return ba;return ba-1;},getViewBounds:function s(t,u,v){v=v||i;var w=u.width/2,x=u.height/2,y=r.toLatLng(t.center),z=v.latLngToPoint(y,t.zoom),aa=v.pointToLatLng(c('leaflet').point(z.x-w,z.y+x),t.zoom),ba=v.pointToLatLng(c('leaflet').point(z.x+w,z.y-x),t.zoom);return r.normalizedBounds(aa,ba);},isViewInBounds:function s(t,u,v,w){var x=r.getViewBounds(t,u,w),y=r.shiftBoundsLng(x,j);return v.some(function(z){return z.contains(x)||z.contains(y);});},projectCircle:function s(t,u,v){v=v||i;var w=r.toLatLng(t.center),x=v.projection,y=r.circleBounds(w,t.radius,x),z=v.latLngToPoint(y.getCenter(),u),aa=v.latLngToPoint(y.getSouthWest(),u),ba=v.latLngToPoint(y.getNorthEast(),u),ca=c('leaflet').point(Math.round((ba.x-aa.x)/2),Math.round((aa.y-ba.y)/2));return {center:z,radius:ca};},circleBounds:function s(t,u,v){v=v||i.projection;var w=t.lat,x=t.lng,y=u/n*m,z=v.project(c('leaflet').latLng(w+y,x)),aa=v.project(c('leaflet').latLng(w-y,x)),ba=z.add(aa).divideBy(2),ca=v.unproject(ba).lat,da=w*l,ea=ca*l,fa=Math.acos((Math.cos(y*l)-Math.sin(da)*Math.sin(ea))/(Math.cos(da)*Math.cos(ea)))*m;return c('leaflet').latLngBounds(c('leaflet').latLng(ca-y,x-fa),c('leaflet').latLng(ca+y,x+fa));},shiftBoundsLng:function s(t,u){return c('leaflet').latLngBounds([t.getSouthWest().lat,t.getSouthWest().lng+u],[t.getNorthEast().lat,t.getNorthEast().lng+u]);},toLatLng:function s(t){return new (c('leaflet').LatLng)(t.latitude,t.longitude);},wrapLongitude:function s(t){return c('mod')(t+k,j)-k;},areViewEqual:function s(t,u){if(!t&&!u)return true;if(!t||!u)return false;return t.zoom===u.zoom&&t.center.latitude===u.center.latitude&&t.center.longitude===u.center.longitude;},metersToPixels:function s(t,u){return t/(o*Math.abs(Math.cos(u.center.latitude*l))/Math.pow(2,u.zoom+8));},distanceFromLatLng:function s(t,u,v){var w=u/n,x=v*l,y=t.lat*l,z=t.lng*l,aa=Math.sin(y),ba=Math.cos(y),ca=Math.sin(w),da=Math.cos(w),ea=Math.sin(x),fa=Math.cos(x),ga=aa*da+ba*ca*fa,ha=Math.asin(ga),ia=ea*ca*ba,ja=da-aa*ga,ka=z+Math.atan2(ia,ja);return new (c('leaflet').LatLng)(ha*m,r.wrapLongitude(ka*m));}};f.exports=r;}),null);
__d('LeafletMap.react',['invariant','ElementResizeEmitter','LeafletMapLayer.react','LeafletUtils','LeafletView','React','ReactDOM','Set','debounceCore','emptyFunction','forEachDifference','leaflet','nullthrows'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes,l=100,m=10,n=new (c('Set'))(['dragging','touchZoom','doubleClickZoom','scrollWheelZoom','boxZoom','keyboard','tab']),o=k.instanceOf(c('LeafletView'));function p(v){var w=v.getCenter();return new (c('LeafletView'))({center:c('LeafletUtils').fromLatLng(w),zoom:v.getZoom()});}function q(v,w){return {center:[v.center.latitude,v.center.longitude],zoom:v.zoom,attributionControl:false,layers:w,trackResize:false};}function r(v,w,x){if(!n.has(w))throw new Error('cannot change Leaflet option `'+w+'` during component lifetime');v[w][x?'enable':'disable']();}function s(v,w,x){if(w===x)return;c('forEachDifference')(w,x,{onLeft:function y(z,aa){return r(v,aa,z);},onRight:function y(z,aa){throw new Error('reverting Leaflet option `'+aa+'` back to default is not supported');},onBoth:function y(z,aa,ba){if(z!==aa)r(v,ba,z);}});}function t(v,w,x){c('forEachDifference')(w,x,{onLeft:function y(z,aa){return void v.on(aa,z);},onRight:function y(z,aa){return void v.off(aa,z);},onBoth:function y(z,aa,ba){if(z!==aa){v.off(ba,aa);v.on(ba,z);}}});}i=babelHelpers.inherits(u,c('React').Component);j=i&&i.prototype;function u(){var v,w;for(var x=arguments.length,y=Array(x),z=0;z<x;z++)y[z]=arguments[z];return w=(v=j.constructor).call.apply(v,[this].concat(y)),this.$LeafletMap4=function(aa){if(this.$LeafletMap3){this.$LeafletMap3.addLayer(aa);return;}this.$LeafletMap11().push(aa);}.bind(this),this.$LeafletMap5=function(aa){this.$LeafletMap3!==undefined||h(0);if(this.$LeafletMap3!==null)this.$LeafletMap3.removeLayer(aa);}.bind(this),w;}u.prototype.getChildContext=function(){return {onAddLayer:this.$LeafletMap4,onRemoveLayer:this.$LeafletMap5};};u.prototype.componentDidMount=function(){var v=Object.assign({},this.props.defaultOptions,this.props.options,q(this.$LeafletMap10(),this.$LeafletMap11())),w=this.$LeafletMap3=c('leaflet').map(c('ReactDOM').findDOMNode(this),v);this.$LeafletMap1=null;this.$LeafletMap8=c('debounceCore')(this.$LeafletMap12.bind(this),l);t(w,this.props.eventHandlers,{});w.on('movestart',this.$LeafletMap13.bind(this));w.on('moveend',this.$LeafletMap14.bind(this));this.$LeafletMap2='still';this.$LeafletMap9=new (c('Set'))();this.$LeafletMap7=c('debounceCore')(function(x,y){if(this.$LeafletMap3)this.$LeafletMap3.setView(x,y);}.bind(this),m);this.$LeafletMap6=new (c('ElementResizeEmitter'))(c('ReactDOM').findDOMNode(this)).add(function(){var x=this.$LeafletMap3;if(x!=null){x.invalidateSize();c('nullthrows')(this.props.onSizeSettled)(x.getSize());}}.bind(this));};u.prototype.componentDidUpdate=function(v){var w=this.$LeafletMap3;if(w==null)return;var x=this.props,y=x.eventHandlers,z=x.options;t(w,y,v.eventHandlers);s(w,z,v.options);this.$LeafletMap16(v.view);};u.prototype.componentWillUnmount=function(){this.$LeafletMap6.remove();if(this.$LeafletMap3!=null)this.$LeafletMap3.remove();this.$LeafletMap3=null;};u.prototype.render=function(){var v=c('React').Children.map(this.props.children,function(w,x){if(!w)return w;if(w.type.toLayer==null)return w;return c('React').createElement(c('LeafletMapLayer.react'),{key:w.key,onAddLayer:this.$LeafletMap4,onRemoveLayer:this.$LeafletMap5},w);}.bind(this));return c('React').createElement('div',{className:this.props.className,style:babelHelpers['extends']({display:'relative'},this.props.style)},v);};u.prototype.$LeafletMap11=function(){if(!this.$LeafletMap1)this.$LeafletMap1=[];return this.$LeafletMap1;};u.prototype.$LeafletMap10=function(){if(this.props.view)return this.props.view;if(this.props.defaultView)return this.props.defaultView;return c('LeafletView').DEFAULT;};u.prototype.$LeafletMap14=function(){if(!this.$LeafletMap3)return;var v=p(this.$LeafletMap3),w=this.$LeafletMap2;this.$LeafletMap2='still';if(this.props.view){if(w==='moving-stale'){this.$LeafletMap12();return;}if(v.nearlyEquals(this.props.view))return;this.$LeafletMap8();}if(!this.props.onViewChange)return;this.props.onViewChange(v);};u.prototype.$LeafletMap13=function(){if(!this.$LeafletMap3)return;if(this.$LeafletMap2==='still')this.$LeafletMap2='moving';};u.prototype.$LeafletMap12=function(){this.$LeafletMap8.reset();if(this.$LeafletMap2==='moving')this.$LeafletMap2='moving-stale';var v=this.props.view,w=this.$LeafletMap3;if(v==null||w==null||v.nearlyEquals(p(w)))return;this.$LeafletMap7([v.center.latitude,v.center.longitude],v.zoom);};u.prototype.$LeafletMap16=function(v){var w=this.props.view;if(!w||!this.$LeafletMap3||w===v||v&&w.nearlyEquals(v))return;this.$LeafletMap12();};u.prototype.$LeafletMap15=function(v,w){if(v[w]!==this.props[w]&&!this.$LeafletMap9.has(w))this.$LeafletMap9.add(w);};u.propTypes={className:k.string,defaultOptions:k.object,defaultView:k.instanceOf(c('LeafletView')),eventHandlers:k.object,onSizeSettled:k.func,onViewChange:k.func,options:k.object,style:k.object,view:function v(w,x,y){for(var z=arguments.length,aa=Array(z>3?z-3:0),ba=3;ba<z;ba++)aa[ba-3]=arguments[ba];var ca=o.apply(undefined,[w,x,y].concat(aa));if(!w[x]||ca)return ca;if(w[x]&&w.defaultView)return new Error('You provided both `view` and `defaultView` props to LeafletMap. '+'`defaultView` will be discarded.');if(w.onViewChange)return null;return new Error('You provided a `view` prop to LeafletMap without an '+'`onViewChange` handler. This will prevent the user to move the '+'view. If the view should be movable use `defaultView`. Otherwise, '+'set `onViewChange`.');}};u.defaultProps={eventHandlers:{},onSizeSettled:c('emptyFunction'),options:{}};u.childContextTypes={onAddLayer:k.func.isRequired,onRemoveLayer:k.func.isRequired};f.exports=u;}),null);
__d('LeafletMarker.react',['GeoCoordinates','LeafletLayer.react','LeafletUtils','React','areEqual','leaflet','nullthrows'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('React').Component);i=h&&h.prototype;j.prototype.$LeafletMarker1=function(k,l,m){var n=m.options||{},o=n.opacity,p=n.zIndex,q=babelHelpers.objectWithoutProperties(n,['opacity','zIndex']),r=l.options||{},s=r.opacity,t=r.zIndex,u=babelHelpers.objectWithoutProperties(r,['opacity','zIndex']);if(!c('areEqual')(u,q))return false;if(s!==o)k.setOpacity(s);if(t!==p)k.setZIndex(t);if(l.coordinates!==m.coordinates)k.setLatLng(c('LeafletUtils').toLatLng(l.coordinates));var v=l.popup;if(v){var w=v.type.mutate(k.getPopup(),v.props,c('nullthrows')(m.popup).props);if(!w){k.unbindPopup();k.bindPopup(v.type.toLayer(v.props,k));}}else if(!v&&m.popup)k.unbindPopup();c('LeafletLayer.react').mutateEventHandlers(k,l.eventHandlers,m.eventHandlers);return true;};j.prototype.$LeafletMarker2=function(k){var l=c('leaflet').marker(c('LeafletUtils').toLatLng(k.coordinates),k.options);if(k.popup)l.bindPopup(k.popup.type.toLayer(k.popup.props,l));c('LeafletLayer.react').addEventHandlers(l,k.eventHandlers);return l;};j.prototype.render=function(){return c('React').createElement(c('LeafletLayer.react'),babelHelpers['extends']({},this.props,{onCreateLayer:this.$LeafletMarker2,onUpdateLayer:this.$LeafletMarker1}));};function j(){h.apply(this,arguments);}f.exports=j;}),null);
__d('LeafletTileLayer.react',['LeafletLayer.react','React','areEqual','leaflet'],(function a(b,c,d,e,f,g){var h,i,j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').Component);i=h&&h.prototype;k.prototype.render=function(){'use strict';return c('React').createElement(c('LeafletLayer.react'),babelHelpers['extends']({},this.props,{onCreateLayer:l,onUpdateLayer:m}));};function k(){'use strict';h.apply(this,arguments);}k.propTypes={options:j.object,urlTemplate:j.string.isRequired};function l(n){return c('leaflet').tileLayer(n.urlTemplate,n.options);}function m(n,o,p){var q=p.options||{},r=q.opacity,s=q.zIndex,t=babelHelpers.objectWithoutProperties(q,['opacity','zIndex']),u=o.options||{},v=u.opacity,w=u.zIndex,x=babelHelpers.objectWithoutProperties(u,['opacity','zIndex']);if(!c('areEqual')(x,t))return false;if(v!==r)n.setOpacity(v);if(w!==s)n.setZIndex(w);if(o.urlTemplate!==p.urlTemplate)n.setUrl(o.urlTemplate);return true;}f.exports=k;}),null);
__d('GeoRectangle',['GeoCoordinates','ImmutableObject'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('ImmutableObject'));i=h&&h.prototype;function j(k,l,m,n){'use strict';i.constructor.call(this,{n:k,w:l,s:m,e:n});}j.prototype.containsLat=function(k){'use strict';return k>=this.s&&k<=this.n;};j.prototype.getCenter=function(){'use strict';var k=(this.n+this.s)/2,l;l=(this.e+this.w)/2;if(this.w>this.e){l-=180;if(l<-180)l+=360;}return {latitude:k,longitude:l};};j.prototype.containsLon=function(k){'use strict';if(this.w>this.e)return k>=this.w||k<=this.e;return k>=this.w&&k<=this.e;};j.prototype.getHeight=function(){'use strict';return this.n-this.s;};j.prototype.getWidth=function(){'use strict';var k=this.e;if(this.w>this.e)k+=360;return k-this.w;};j.prototype.containsPoint=function(k,l){'use strict';return this.containsLat(k)&&this.containsLon(l);};j.prototype.containsGeoRectangle=function(k){'use strict';return this.containsPoint(k.n,k.w)&&this.containsPoint(k.s,k.e);};j.prototype.toArray=function(){'use strict';return {n:this.n,w:this.w,s:this.s,e:this.e};};j.fromPoints=function(k){if(!k||k.length===0)return null;if(k.length===1){var l=k[0];return new j(l.latitude,l.longitude,l.latitude,l.longitude);}var m=k.map(function(t){return t.latitude;}),n=k.map(function(t){return t.longitude;}).sort(function(t,u){return t-u;}),o=360+n[0]-n[n.length-1],p=n.length-1,q=0;for(var r=0;r<n.length-1;r++){var s=n[r+1]-n[r];if(s>o){o=s;p=r;q=r+1;}}return new j(Math.max.apply(Math,m),n[q],Math.min.apply(Math,m),n[p]);};f.exports=j;}),null);
__d('TilesMapUtils',['CurrentLocale','GeoCoordinates','GeoRectangle','LeafletUtils','LeafletView','TilesMapConfig','TilesMapTheme','URI','leaflet'],(function a(b,c,d,e,f,g){'use strict';var h=c('TilesMapConfig').OSM_RECTS_RAW.map(function(j){return c('leaflet').latLngBounds([j[2],j[1]],[j[0],j[3]]);}),i={DEFAULT_VIEW:new (c('LeafletView'))({center:new (c('GeoCoordinates'))(0,0),zoom:c('TilesMapConfig').ZOOM_RANGE.MIN}),getTileURLTemplate:function j(k,l){if(!k)k=c('CurrentLocale').get();return c('TilesMapConfig').TILE_URL_TEMPLATE+'&language='+k+(l&&l!==c('TilesMapTheme').DEFAULT?'&theme='+l:'')+(l===c('TilesMapTheme').LIVE_MAPS?'&lmv='+c('TilesMapConfig').LIVE_MAP_VERSION:'');},getOSMRects:function j(){return i.getOSMRectsFromRaw(c('TilesMapConfig').OSM_RECTS_RAW);},getOSMRectsFromRaw:function j(k){return k.map(function(l){return new (c('GeoRectangle'))(l[0],l[1],l[2],l[3]);});},getMapProviderForAttribution:function j(k,l,m,n){if(n===c('TilesMapTheme').CROWDSOURCING_PPM_DG)return 'DG';if(l.height<c('TilesMapConfig').MIN_SIZE_FOR_ATTRIBUTION||l.width<c('TilesMapConfig').MIN_SIZE_FOR_ATTRIBUTION)return null;if(n!==''&&n!==c('TilesMapTheme').DEFAULT&&n!==c('TilesMapTheme').CROWDSOURCING_PPM_DG&&n!==c('TilesMapTheme').ROAD_MASK_OSM_EDITING)return 'OSM';if(k.zoom<c('TilesMapConfig').OSM_ZOOM_THRESHOLD)return 'HERE';return c('LeafletUtils').isViewInBounds(k,l,h,m)?'OSM':'HERE';},getMapProviderForReportButton:function j(k,l){if(l===c('TilesMapTheme').CROWDSOURCING_PPM_DG)throw new Error('Unsupported theme CROWDSOURCING_PPM_DG');if(l!==''&&l!==c('TilesMapTheme').DEFAULT&&l!==c('TilesMapTheme').CROWDSOURCING_PPM_DG&&l!==c('TilesMapTheme').ROAD_MASK_OSM_EDITING)return 'OSM';if(k.zoom<c('TilesMapConfig').OSM_ZOOM_THRESHOLD)return 'HERE';var m=c('leaflet').latLng(k.center.latitude,k.center.longitude);return h.some(function(n){return n.contains(m);})?'OSM':'HERE';},getReporterToolUrl:function j(k,l){switch(k){case 'OSM':var m=Math.max(Math.floor(l.zoom),c('TilesMapConfig').OSM_MAP_MIN_ZOOM_TO_REPORT_ISSUE);return new (c('URI'))(c('TilesMapConfig').OSM_MAP_REPORTER_URL).addQueryData('lat',l.center.latitude).addQueryData('lon',l.center.longitude).addQueryData('zoom',m).toString();default:case 'HERE':return new (c('URI'))(c('TilesMapConfig').HERE_MAP_REPORTER_URL).addQueryData('features','road,border').addQueryData('zoomLevel',Math.floor(l.zoom)).addQueryData('lang',c('CurrentLocale').get()).addQueryData('coord',l.center.latitude+','+l.center.longitude).toString();}}};f.exports=i;}),null);
__d('MessengerDynamicMap.react',['CurrentLocale','GeoCoordinates','leaflet','LeafletMap.react','LeafletMarker.react','LeafletTileLayer.react','LeafletUtils','LeafletView','React','TilesMapUtils'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('React').PropTypes,k={tap:false},l={icon:c('leaflet').icon({iconUrl:'https://www.facebook.com/images/places/map/bright-pink-pin.png',iconSize:[20,27],iconAnchor:[9,24]}),draggable:true};h=babelHelpers.inherits(m,c('React').PureComponent);i=h&&h.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=i.constructor).call.apply(n,[this].concat(q)),this.$MessengerDynamicMap1=new (c('LeafletView'))({center:new (c('GeoCoordinates'))(this.props.lat,this.props["long"]),zoom:this.props.zoom}),this.$MessengerDynamicMap2=function(event){var s=event.target&&event.target.getLatLng(),t=c('LeafletUtils').fromLatLng(s);this.props.onMarkerDragEnd(t&&t.latitude,t&&t.longitude);}.bind(this),o;}m.prototype.render=function(){var n=c('TilesMapUtils').getTileURLTemplate(c('CurrentLocale').get());return c('React').createElement(c('LeafletMap.react'),{defaultOptions:k,defaultView:this.$MessengerDynamicMap1,style:{height:this.props.height+'px',width:this.props.width+'px'}},c('React').createElement(c('LeafletTileLayer.react'),{urlTemplate:n}),c('React').createElement(c('LeafletMarker.react'),{coordinates:new (c('GeoCoordinates'))(this.props.lat,this.props["long"]),eventHandlers:{dragstart:this.props.onMarkerDragStart,dragend:this.$MessengerDynamicMap2},options:l}));};m.defaultProps={zoom:15};m.propTypes={lat:j.number.isRequired,"long":j.number.isRequired,height:j.number.isRequired,width:j.number.isRequired,onMarkerDragEnd:j.func.isRequired,onMarkerDragStart:j.func.isRequired,zoom:j.number.isRequired};f.exports=m;}),null);
__d('HoverAnimatedSticker.react',['React','Relay','Sticker.react','StickerUtils'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=Math.floor(120*window.devicePixelRatio);h=babelHelpers.inherits(k,c('React').Component);i=h&&h.prototype;k.prototype.render=function(){var l=this.props.sticker,m=l.image?l.image.uri:null,n=l.sprite_image?l.sprite_image.uri:null,o=this.props.animationTrigger||'hover',p=c('StickerUtils').getScaledDimensions(l.image.height,l.image.width,this.props.maxDimension),q=p.height,r=p.width;return c('React').createElement(c('Sticker.react'),{animationTrigger:o,forceCursorPointer:this.props.forceCursorPointer,frameCount:l.frame_count,frameRate:l.frame_rate,framesPerCol:l.frames_per_column,framesPerRow:l.frames_per_row,sourceURI:m,sourceWidth:r,sourceHeight:q,spriteURI:n});};function k(){h.apply(this,arguments);}f.exports=c('Relay').createContainer(k,{fragments:{sticker:function l(){return function(m,n,o,p){return {children:[{fieldName:'frame_count',kind:'Field',metadata:{},type:'Int'},{fieldName:'frame_rate',kind:'Field',metadata:{},type:'Int'},{fieldName:'frames_per_column',kind:'Field',metadata:{},type:'Int'},{fieldName:'frames_per_row',kind:'Field',metadata:{},type:'Int'},{calls:[{kind:'Call',metadata:{type:'Int'},name:'width',value:c('Relay').QL.__var(m)},{kind:'Call',metadata:{type:'Int'},name:'height',value:c('Relay').QL.__var(n)}],children:[{fieldName:'uri',kind:'Field',metadata:{},type:'Url'},{fieldName:'width',kind:'Field',metadata:{},type:'Int'},{fieldName:'height',kind:'Field',metadata:{},type:'Int'}],fieldName:'image',kind:'Field',metadata:{canHaveSubselections:true},type:'Image'},{calls:[{kind:'Call',metadata:{type:'Int'},name:'width',value:c('Relay').QL.__var(o)},{kind:'Call',metadata:{type:'Int'},name:'height',value:c('Relay').QL.__var(p)}],children:[{fieldName:'uri',kind:'Field',metadata:{},type:'Url'}],fieldName:'sprite_image',kind:'Field',metadata:{canHaveSubselections:true},type:'Image'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],id:c('Relay').QL.__id(),kind:'Fragment',metadata:{},name:'HoverAnimatedSticker_react_StickerRelayQL',type:'Sticker'};}(j,j,j,j);}}});}),null);
__d('HoverAnimatedStickerRoute',['RelayQL','RelayRoute'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('RelayRoute'));i=h&&h.prototype;function j(){h.apply(this,arguments);}j.routeName='HoverAnimatedStickerRoute';j.paramDefinitions={id:{required:true,type:'String'}};j.queries={sticker:function k(l){return function(m){return {calls:[{kind:'Call',metadata:{type:'ID!'},name:'id',value:{kind:'CallVariable',callVariableName:'id'}}],children:[].concat.apply([],[{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'},c('RelayQL').__frag(m)]),fieldName:'node',kind:'Query',metadata:{isAbstract:true,identifyingArgName:'id',identifyingArgType:'ID!'},name:'HoverAnimatedStickerRoute',type:'Node'};}(l.getFragment('sticker'));}};f.exports=j;}),null);
__d('MessengerBotsQuickReplyButton.react',['cx','ix','MessengerEnvironment','HoverAnimatedSticker.react','HoverAnimatedStickerRoute','Image.react','MessengerConfig','React','RelayRootContainer','ShimButton.react','XUISpinner.react','joinClasses'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l,m,n,o,p,q,r,s,t,u,v=c('React').PropTypes;j=babelHelpers.inherits(w,c('React').Component);k=j&&j.prototype;w.prototype.render=function(){var ca=this.props.option;return c('React').createElement('div',{className:(ca.dismissed?"_18m_":'')+(' '+"_56n2")},this.$MessengerBotsQuickReplyButton1());};w.prototype.$MessengerBotsQuickReplyButton1=function(){switch(this.props.option.content_type){case 'text':return c('React').createElement(x,babelHelpers['extends']({imageUrl:this.$MessengerBotsQuickReplyButton2()},this.props));case 'sticker':return c('React').createElement(z,this.props);case 'location':case 'p2p_payment':case 'ride_service':return c('React').createElement(y,babelHelpers['extends']({imageUrl:this.$MessengerBotsQuickReplyButton2()},this.props));default:return null;}};w.prototype.$MessengerBotsQuickReplyButton2=function(){var ca=this.props.option,da=c('MessengerEnvironment').messengerui;switch(ca.content_type){case 'location':if(da){return i("87219");}else return i("87222");case 'p2p_payment':return da?i("87227"):i("87226");case 'ride_service':return da?i("87289"):i("87288");default:return ca.image_url;}};function w(){j.apply(this,arguments);}w.propTypes={option:v.object.isRequired,onClick:v.func.isRequired,setPreview:v.func.isRequired};l=babelHelpers.inherits(x,c('React').Component);m=l&&l.prototype;x.prototype.render=function(){var ca=this.props,da=ca.option,ea=ca.onClick,fa=ca.imageUrl,ga=c('MessengerEnvironment').messengerui,ha=c('MessengerConfig').MessengerIconQuickReply,ia=ha&&!!fa;return c('React').createElement(c('ShimButton.react'),{className:c('joinClasses')(this.props.className,"_3u69"+(ga?' '+"_36wf":'')+(ga&&!ia?' '+"_2pi9":'')+(!ga?' '+"_-lq":'')+(!ga&&!ia?' '+"_2pi8":'')),onClick:ea},ia&&fa?c('React').createElement(aa,{imageUrl:fa}):null,c('React').createElement(ba,{hasIcon:ia,title:da&&da.title}));};function x(){l.apply(this,arguments);}x.propTypes={option:v.object.isRequired,imageUrl:c('Image.react').validateImageSrcPropType,onClick:v.func.isRequired};n=babelHelpers.inherits(y,c('React').Component);o=n&&n.prototype;y.prototype.render=function(){var ca=this.props,da=ca.option,ea=ca.onClick,fa=ca.imageUrl,ga=c('MessengerEnvironment').messengerui,ha=this.$ActionButton1();return c('React').createElement(c('ShimButton.react'),{className:c('joinClasses')(this.props.className,"_3u69"+(!ha?' '+"_5pdw":'')+(ga?' '+"_10-b":'')+(ga&&ha?' '+"_5pdx":'')+(!ga?' '+"_-lq":'')+(!ga&&ha?' '+"_5pdy":'')),onClick:ea},fa?c('React').createElement(aa,{imageUrl:fa}):null,c('React').createElement(ba,{hasIcon:!!fa,title:da&&da.title}));};y.prototype.$ActionButton1=function(){switch(this.props.option.content_type){case 'p2p_payment':return false;case 'location':return !c('MessengerEnvironment').messengerui;default:return true;}};function y(){n.apply(this,arguments);}y.propTypes={option:v.object.isRequired,imageUrl:c('Image.react').validateImageSrcPropType,onClick:v.func.isRequired};p=babelHelpers.inherits(z,c('React').PureComponent);q=p&&p.prototype;function z(){var ca,da;for(var ea=arguments.length,fa=Array(ea),ga=0;ga<ea;ga++)fa[ga]=arguments[ga];return da=(ca=q.constructor).call.apply(ca,[this].concat(fa)),this.state={clearPreviewFn:null},this.$StickerButton3=function(){var ha=c('React').createElement(c('RelayRootContainer'),{Component:c('HoverAnimatedSticker.react'),route:new (c('HoverAnimatedStickerRoute'))({id:this.$StickerButton2()}),renderFetched:function ja(ka){return c('React').createElement(c('HoverAnimatedSticker.react'),babelHelpers['extends']({},ka,{animationTrigger:'load_and_hover',forceCursorPointer:true,maxDimension:120}));}}),ia=this.props.setPreview(ha);this.setState({clearPreviewFn:ia});}.bind(this),this.$StickerButton4=function(){this.$StickerButton1();}.bind(this),da;}z.prototype.componentWillUnmount=function(){this.$StickerButton1();};z.prototype.render=function(){var ca=this.props.onClick,da=c('MessengerEnvironment').messengerui,ea=this.$StickerButton2();if(!ea)return null;var fa=da?44:36;return c('React').createElement('div',{className:c('joinClasses')(this.props.className,"_3u69"+(' '+"_59x7")),onClick:ca,onMouseEnter:this.$StickerButton3,onMouseLeave:this.$StickerButton4,role:'presentation'},c('React').createElement(c('RelayRootContainer'),{Component:c('HoverAnimatedSticker.react'),route:new (c('HoverAnimatedStickerRoute'))({id:ea}),renderLoading:function ga(ha){return c('React').createElement(c('XUISpinner.react'),{background:'light',size:'small'});},renderFetched:function ga(ha){return c('React').createElement(c('HoverAnimatedSticker.react'),babelHelpers['extends']({},ha,{forceCursorPointer:true,maxDimension:fa}));}}));};z.prototype.$StickerButton2=function(){var ca=this.props.option,da=ca.data;return da&&da.sticker_id;};z.prototype.$StickerButton1=function(){this.state.clearPreviewFn?this.state.clearPreviewFn():null;};z.propTypes={option:v.object.isRequired,onClick:v.func.isRequired,setPreview:v.func.isRequired};r=babelHelpers.inherits(aa,c('React').Component);s=r&&r.prototype;aa.prototype.render=function(){var ca=this.props.imageUrl,da=c('MessengerEnvironment').messengerui;return c('React').createElement(c('Image.react'),{src:ca,className:(da?"_10-a":'')+(!da?' '+"_10-9":'')+(!da?' '+"_3-8h":'')});};function aa(){r.apply(this,arguments);}aa.propTypes={imageUrl:c('Image.react').validateImageSrcPropType};t=babelHelpers.inherits(ba,c('React').Component);u=t&&t.prototype;ba.prototype.render=function(){var ca=this.props,da=ca.hasIcon,ea=ca.title,fa=c('MessengerEnvironment').messengerui;return c('React').createElement('div',{className:(fa?"_10-e":'')+(fa&&da?' '+"_10-f":'')+(fa&&da?' '+"_3-91":'')+(!fa?' '+"_10-c":'')+(!fa&&da?' '+"_10-d":'')+(!fa&&da?' '+"_3-90":'')},ea);};function ba(){t.apply(this,arguments);}ba.propTypes={hasIcon:v.bool.isRequired,title:v.string.isRequired};f.exports=w;}),null);
__d('MNOmniMConstants',['keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({OMNIM:null,QUICKREPLIES:null});f.exports=babelHelpers['extends']({},h,{SUGGESTION_MODES:['conservative','balanced','aggressive','muted']});}),null);
__d('OmniMActions',['MessengerFluxReduceDispatcher','keyMirror','setImmediate'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({BAR_DISMISSED:null,BAR_DISPLAYED:null,BAR_DISAPPEARED:null,BAR_TIMED_OUT:null,MERCURY_DISPATCHED:null,FETCH_SUGGESTIONS:null,PREFS_UPDATED:null,SUGGESTION_CLICKED:null,SUGGESTION_COMPLETED:null,SUGGESTION_DISMISSED:null,SUGGESTION_DISPLAYED:null,SUGGESTION_DISAPPEARED:null,SUGGESTION_MODE_SET:null,SUGGESTIONS_DISMISSED_FOR_THREAD:null}),i='omnim',j={Types:h,Namespace:i,mercuryDispatched:function k(l,m){c('MessengerFluxReduceDispatcher').dispatch({type:h.MERCURY_DISPATCHED,namespace:i,mercuryType:l,data:m});},messageFetched:function k(l,m){c('setImmediate')(function(){c('MessengerFluxReduceDispatcher').dispatch({type:h.FETCH_SUGGESTIONS,namespace:i,threadID:l,message:m});});},suggestionClicked:function k(l,m,n,o){c('MessengerFluxReduceDispatcher').dispatch({type:h.SUGGESTION_CLICKED,namespace:i,threadID:l,option:m,source:n,position:o});},suggestionCompleted:function k(l,m,n,o){c('MessengerFluxReduceDispatcher').dispatch({type:h.SUGGESTION_COMPLETED,namespace:i,threadID:l,option:m,source:n,position:o});},suggestionDismissed:function k(l,m,n,o){c('MessengerFluxReduceDispatcher').dispatch({type:h.SUGGESTION_DISMISSED,namespace:i,threadID:l,option:m,source:n,position:o});},suggestionsDismissedForThread:function k(l){c('MessengerFluxReduceDispatcher').dispatch({type:h.SUGGESTIONS_DISMISSED_FOR_THREAD,namespace:i,threadID:l});},suggestionDisplayed:function k(l,m){c('setImmediate')(function(){c('MessengerFluxReduceDispatcher').dispatch({type:h.SUGGESTION_DISPLAYED,namespace:i,option:l,position:m});});},suggestionDisappeared:function k(l,m){c('setImmediate')(function(){c('MessengerFluxReduceDispatcher').dispatch({type:h.SUGGESTION_DISAPPEARED,namespace:i,option:l,position:m});});},prefsUpdated:function k(l){c('MessengerFluxReduceDispatcher').dispatch({type:h.PREFS_UPDATED,namespace:i,prefs:l});},suggestionModeSet:function k(l){c('MessengerFluxReduceDispatcher').dispatch({type:h.SUGGESTION_MODE_SET,namespace:i,mode:l});},barDismissed:function k(l){c('MessengerFluxReduceDispatcher').dispatch({type:h.BAR_DISMISSED,namespace:i,options:l});},barDisplayed:function k(l){c('setImmediate')(function(){c('MessengerFluxReduceDispatcher').dispatch({type:h.BAR_DISPLAYED,namespace:i,options:l});});},barDisappeared:function k(l){c('setImmediate')(function(){c('MessengerFluxReduceDispatcher').dispatch({type:h.BAR_DISAPPEARED,namespace:i,options:l});});},barTimedOut:function k(l,m){c('setImmediate')(function(){c('MessengerFluxReduceDispatcher').dispatch({type:h.BAR_TIMED_OUT,namespace:i,options:m,threadID:l});});}};f.exports=j;}),null);
__d('messengerDynamicMapReact',['bs_curry','reasonReact','MessengerDynamicMap.react'],(function a(b,c,d,e,f,g){'use strict';function h(j,k,l){return c('bs_curry')._1(j,[k,l]);}function i(j,k,l,m,n,o,p){return c('reasonReact').wrapJsForReason(c('MessengerDynamicMap.react'),{lat:j,"long":k,onMarkerDragEnd:function q(r,s){return c('bs_curry')._1(l,[r,s]);},onMarkerDragStart:m,height:n,width:o},p);}g.makeTwoArgTuple=h;g.make=i;}),null);
__d('messengerSendLocationDialogReact',['cx','fbt','bs_block','bs_curry','React','utilsRe','CurrentUser','reasonReact','PhotosUploadID','messengerDialogsRe','MercuryMessageObject','messengerDialogReact','MercuryAttachmentType','MercuryMessageActions','messengerSpinnerReact','MercuryTriodeSourceUtil','messengerDialogBodyReact','messengerDynamicMapReact'],(function a(b,c,d,e,f,g,h,i){'use strict';var j={enableHighAccuracy:true,timeout:60000,maximumAge:120000};function k(){return c('utilsRe').isTruthy(navigator&&'geolocation' in navigator);}function l(aa){if(aa){return 0;}else return c('messengerDialogsRe').removeDialog(0);}function m(aa,ba){var ca=ba[3];return c('bs_block').__(0,[[ca[0],ca[1],[aa[0]],[aa[1]],ca[4]]]);}function n(aa,ba){return m([aa.coords.latitude,aa.coords.longitude],ba);}function o(aa,ba){var ca=ba[3],da=aa.code,ea=da!==1?[i._("Sorry, something went wrong. Please try again or send your location from the Messenger app."),i._("Couldn't Find Location")]:[i._("Messenger needs permission to access your location. Please update your browser settings or use the Messenger app."),i._("Permission Required")];return c('bs_block').__(0,[[[ea[0]],[ea[1]],ca[2],ca[3],ca[4]]]);}function p(aa,ba){var ca=c('utilsRe').isTruthy(navigator&&'geolocation' in navigator),da=ba[3][4];if(ca!==0&&da){navigator.geolocation.clearWatch(da[0]);return 0;}else return 0;}function q(aa){return c('utilsRe').$pipe$unknown(aa[1],i._("Your Location"));}function r(aa,ba){var ca=aa[0],da=aa[2],ea=aa[3];if(ca){return ca[0];}else{var fa=0;if(da){if(ea){return c('reasonReact').element(0,0,c('messengerDynamicMapReact').make(da[0],ea[0],c('bs_curry')._1(ba[2],m),c('bs_curry')._1(ba[1],p),500,500,[]));}else fa=1;}else fa=1;if(fa===1)return c('React').createElement("div",{className:"_j4g"},c('reasonReact').element(0,0,c('messengerSpinnerReact').make(0,0,0,[])));}}function s(aa){var ba=aa[3];if(c('utilsRe').isTruthy(navigator&&'geolocation' in navigator)){ba[4]=[navigator.geolocation.watchPosition(c('bs_curry')._1(aa[2],n),c('bs_curry')._1(aa[2],o),j)];return 0;}else return c('bs_block').__(0,[[[i._("Your browser doesn't support location sharing. You can also send your location from the Messenger app.")],[i._("Location Not Supported")],ba[2],ba[3],ba[4]]]);}function t(aa){return p(0,aa);}var u=c('reasonReact').statefulComponent("MessengerSendLocationDialogReact");function v(aa,ba,ca){var da=function ga(ha,ia){var ja=ia[3];c('messengerDialogsRe').removeDialog(0);var ka=c('CurrentUser').getID(),la=c('MercuryMessageObject').getForFBID(ka),ma=c('MercuryMessageActions').getForFBID(ka),na="upload_"+c('PhotosUploadID').getNewID(),oa=la.constructAttachmentMessageObject(c('MercuryTriodeSourceUtil').getMercuryTriodeSource(),aa),pa=ja[2],qa=ja[3];if(pa)if(qa)oa.location_attachment={coordinates:{latitude:pa[0],longitude:qa[0]},is_current_location:true};var ra={upload_id:na,preview_attachments:[{upload_id:na,attach_type:c('MercuryAttachmentType').PHOTO,preview_uploading:true}]};ma.addAttachmentPlaceholder(oa,na,ra);ma.send(oa,function(){ma.confirmAttachmentPlaceholder(na,{upload_id:na});return 0;},undefined);return c('bs_curry')._1(ba,0);},ea=function ga(ha,ia){var ja=ha[0],ka=ha[2],la=ha[3];if(ja||!(ka&&la)){return null;}else return c('reasonReact').element(0,0,c('bs_curry').app(c('messengerDialogReact').Button[0],[0,[i._("Send Location")],0,0,[c('bs_curry')._1(ia[1],da)],[0],0,0,[]]));},fa=u.slice();fa[4]=s;fa[6]=t;fa[9]=function(ga){var ha=ga[3];return c('reasonReact').element(0,0,c('bs_curry')._8(c('messengerDialogReact').Dialog[0],0,l,0,0,0,0,[548],[c('reasonReact').element(0,0,c('bs_curry')._3(c('messengerDialogReact').Header[0],0,0,[q(ha)])),c('reasonReact').element(0,0,c('messengerDialogBodyReact').make(0,[r(ha,ga)])),c('reasonReact').element(0,0,c('bs_curry')._3(c('messengerDialogReact').Footer[0],0,0,[c('reasonReact').element(0,0,c('bs_curry')._2(c('messengerDialogReact').CancelButton[0],0,[])),ea(ha,ga)]))]));};fa[10]=function(){return [0,0,0,0,0];};return fa;}var w=c('reasonReact').wrapReasonForJs(u,function(aa){return v(aa.threadID,aa.onCompletion,[]);}),x=500,y=500,z=c('utilsRe').$pipe$unknown;g.mapHeight=x;g.mapWidth=y;g.locationOptions=j;g.$pipe$unknown=z;g.isLocationAPISupported=k;g.handleToggle=l;g.updateCoords=m;g.updatePosition=n;g.handleError=o;g.clearWatchLocation=p;g.getTitle=q;g.getBody=r;g.didMount=s;g.willUnmount=t;g.component=u;g.make=v;g.jsComponent=w;}),null);
__d('messengerAskLocationPermissionDialogReact',['fbt','bs_curry','reasonReact','messengerDialogsRe','messengerDialogReact','messengerDialogBodyReact','messengerSendLocationDialogReact'],(function a(b,c,d,e,f,g,h){'use strict';var i=h._("Allow Location Access"),j=h._("Giving Messenger access to your location enables features like sharing where you are with friends. You can turn it off anytime."),k=h._("Allow"),l=c('reasonReact').statefulComponent("MessengerAskLocationPermissionDialogReact");function m(p){if(p){return 0;}else return c('messengerDialogsRe').removeDialog(0);}function n(p,q){var r=function t(){c('messengerDialogsRe').removeDialog(0);return c('messengerDialogsRe').showDialog(function(){return c('reasonReact').element(0,0,c('messengerSendLocationDialogReact').make(p,function(){return 0;},[]));});},s=l.slice();s[9]=function(){return c('reasonReact').element(0,0,c('bs_curry')._8(c('messengerDialogReact').Dialog[0],0,m,0,0,0,0,0,[c('reasonReact').element(0,0,c('bs_curry')._3(c('messengerDialogReact').Header[0],0,0,[i])),c('reasonReact').element(0,0,c('messengerDialogBodyReact').make(0,[j])),c('reasonReact').element(0,0,c('bs_curry')._3(c('messengerDialogReact').Footer[0],0,0,[c('reasonReact').element(0,0,c('bs_curry')._2(c('messengerDialogReact').CancelButton[0],0,[])),c('reasonReact').element(0,0,c('bs_curry').app(c('messengerDialogReact').Button[0],[0,[k],0,0,[r],[0],0,0,[]]))]))]));};return s;}var o=c('reasonReact').wrapReasonForJs(l,function(p){return n(p.threadID,[]);});g.title=i;g.message=j;g.buttonLabel=k;g.component=l;g.handleToggle=m;g.make=n;g.jsComponent=o;}),null);
__d('MessengerBotsQuickReplyButtonContainer.react',['cx','fbt','MessengerEnvironment','CurrentUser','MercuryConfig','MercuryIDs','MercuryMessageActions','MercuryMessageObject','MercurySourceType','messengerAskLocationPermissionDialogReact','MessengerBotsWebTypedLogger','MessengerBotsQuickReplyButton.react','messengerDialogsRe','messengerSendLocationDialogReact','MNBotsLoggerEvents','MNOmniMConstants','OmniMActions','P2PActions','P2PLogger','P2PPaymentLoggerEvent','P2PPaymentLoggerEventFlow','PECurrency','React','SimpleXUIDialog'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('MercuryMessageActions').get(),m=c('messengerAskLocationPermissionDialogReact').jsComponent,n=c('messengerSendLocationDialogReact').jsComponent,o=c('React').PropTypes,p='omni_m';j=babelHelpers.inherits(q,c('React').PureComponent);k=j&&j.prototype;function q(){var r,s;for(var t=arguments.length,u=Array(t),v=0;v<t;v++)u[v]=arguments[v];return s=(r=k.constructor).call.apply(r,[this].concat(u)),this.state={showDismiss:false},this.$MessengerBotsQuickReplyButtonContainer9=function(){if(!c('MercuryConfig').OmniMDismissalDisabled&&this.props.source===c('MNOmniMConstants').OMNIM)this.setState({showDismiss:true});}.bind(this),this.$MessengerBotsQuickReplyButtonContainer7=function(){this.setState({showDismiss:false});}.bind(this),this.$MessengerBotsQuickReplyButtonContainer10=function(){var w=this.props,x=w.threadID,y=w.option,z=w.source,aa=w.index;c('OmniMActions').suggestionCompleted(x,y,z,aa);}.bind(this),this.$MessengerBotsQuickReplyButtonContainer8=function(){var w=this.props,x=w.threadID,y=w.option,z=w.source,aa=w.index;c('OmniMActions').suggestionDismissed(x,y,z,aa);}.bind(this),this.$MessengerBotsQuickReplyButtonContainer1=function(){var w=new (c('MercuryMessageObject'))(c('CurrentUser').getID()),x=this.props,y=x.option,z=x.source,aa=this.props.threadID;l.send(w.constructCTAConfirmationMessageObject(y.title,c('MercurySourceType').TITAN_WEB,aa,y));if(z===c('MNOmniMConstants').QUICKREPLIES)new (c('MessengerBotsWebTypedLogger'))().setEvent(c('MNBotsLoggerEvents').BOT_COMPOSER_QUICK_REPLY_TAPPED).setPageID(c('MercuryIDs').getUserIDFromThreadID(aa)).setPayload(y.payload).setTitle(y.title).setType(y.content_type).setIndex(this.props.index.toString()).log();this.$MessengerBotsQuickReplyButtonContainer10();}.bind(this),this.$MessengerBotsQuickReplyButtonContainer2=function(){var w=c('MessengerEnvironment').messengerui;if(w){if(navigator&&'permissions' in navigator){navigator.permissions.query({name:'geolocation'}).then(function(z){var aa=z&&z.state;if(aa==='prompt'){c('messengerDialogsRe').showDialog(function(){return c('React').createElement(m,{threadID:this.props.threadID});}.bind(this));}else c('messengerDialogsRe').showDialog(function(){return c('React').createElement(n,{threadID:this.props.threadID,onCompletion:this.$MessengerBotsQuickReplyButtonContainer10});}.bind(this));}.bind(this));}else c('messengerDialogsRe').showDialog(function(){return c('React').createElement(n,{threadID:this.props.threadID,onCompletion:this.$MessengerBotsQuickReplyButtonContainer10});}.bind(this));}else{var x=i._("Couldn't Send Location"),y=i._("You can only send your location from the Messenger app.");c('SimpleXUIDialog').show(y,x);}}.bind(this),this.$MessengerBotsQuickReplyButtonContainer4=function(){var w=this.props,x=w.option,y=w.threadID,z=x&&x.data&&x.data.payment_amount,aa=x&&x.data&&x.data.payment_currency,ba=x&&x.data&&x.data.payment_type,ca={referrer:p,threadID:y,openRequestTab:ba==='request',onCompletion:this.$MessengerBotsQuickReplyButtonContainer10};if(z&&aa)ca.amount=c('PECurrency').formatAmount(aa,z,false,false,false,false);c('P2PLogger').log(c('P2PPaymentLoggerEvent').UI_ACTN_SEND_MONEY_OMNIM_SUGGESTION_CLICKED,{www_event_flow:ba==='request'?c('P2PPaymentLoggerEventFlow').UI_FLOW_P2P_REQUEST:c('P2PPaymentLoggerEventFlow').UI_FLOW_P2P_SEND,amount:z,currency:aa,object_id:c('MercuryIDs').getThreadFBIDFromThreadID(y)});c('P2PActions').chatSendViewOpened(ca);}.bind(this),this.$MessengerBotsQuickReplyButtonContainer3=function(){var w=new (c('MercuryMessageObject'))(c('CurrentUser').getID()),x=this.props.option,y=this.props.threadID,z=x.data,aa=z&&z.sticker_id;if(!aa)return;var ba=w.constructStickerMessageObject(aa+'',c('MercurySourceType').TITAN_WEB,y);ba.body='';l.send(ba);this.$MessengerBotsQuickReplyButtonContainer10();}.bind(this),s;}q.prototype.render=function(){var r=this.props,s=r.option,t=r.source,u={text:this.$MessengerBotsQuickReplyButtonContainer1,location:this.$MessengerBotsQuickReplyButtonContainer2,sticker:this.$MessengerBotsQuickReplyButtonContainer3,p2p_payment:this.$MessengerBotsQuickReplyButtonContainer4,ride_service:this.$MessengerBotsQuickReplyButtonContainer5},v=this.$MessengerBotsQuickReplyButtonContainer6(u[s.content_type]);return c('React').createElement('div',{onMouseLeave:this.$MessengerBotsQuickReplyButtonContainer7,className:(s.dismissed?"_18m_":'')+(' '+"_4yx8")+(this.state.showDismiss?' '+"_835":'')+(t===c('MNOmniMConstants').OMNIM?' '+"_4yx9":'')},c('React').createElement('div',{className:"_4yxa",onClick:this.$MessengerBotsQuickReplyButtonContainer8,role:'presentation'}),c('React').createElement('div',{onMouseOver:this.$MessengerBotsQuickReplyButtonContainer9},c('React').createElement(c('MessengerBotsQuickReplyButton.react'),{onClick:v,option:s,className:this.props.className,setPreview:this.props.setPreview})));};q.prototype.$MessengerBotsQuickReplyButtonContainer6=function(r){var s=this.props,t=s.threadID,u=s.option,v=s.source,w=s.index;return function(){c('OmniMActions').suggestionClicked(t,u,v,w);return r.apply(undefined,arguments);};};q.prototype.$MessengerBotsQuickReplyButtonContainer5=function(){var r=i._("Couldn't order ride"),s=i._("You can only order a ride from the Messenger app.");c('SimpleXUIDialog').show(s,r);};q.propTypes={option:o.object.isRequired,threadID:o.string.isRequired,index:o.number.isRequired,source:o.string.isRequired,setPreview:o.func.isRequired};f.exports=q;}),null);
__d('OmniMHelpers',['MercuryConfig'],(function a(b,c,d,e,f,g){function h(i){if(!c('MercuryConfig').OmniMEditConfidenceThreshold)return 0;if(i&&i.has('suggestion_mode')){var j=i.get('suggestion_mode');return j!==null&&j!==undefined?j:1;}return 3;}f.exports={suggestionMode:h};}),null);
__d('MessengerBotsQuickReplyButtonList.react',['cx','fbt','AdsArrowedCarouselEnhanced.react','MessengerEnvironment','immutable','Link.react','MercuryConfig','MercuryIDs','MessengerBotsQuickReplyButtonContainer.react','MessengerBotsWebTypedLogger','MNBotsLoggerEvents','MNOmniMConstants','OmniMActions','OmniMHelpers','React','ShimButton.react','SimpleNUXMessage','SimpleNUXMessageTypes','Visibility','XUIAmbientNUX.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').PureComponent);k=j&&j.prototype;function m(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.state={nuxShown:false,previewItem:null,showPreview:false,showDismiss:false},this.$MessengerBotsQuickReplyButtonList1='mLogo',this.$MessengerBotsQuickReplyButtonList2=null,this.$MessengerBotsQuickReplyButtonList3=null,this.$MessengerBotsQuickReplyButtonList4=function(){if(this.$MessengerBotsQuickReplyButtonList3){clearTimeout(this.$MessengerBotsQuickReplyButtonList3);this.$MessengerBotsQuickReplyButtonList3=null;}if(c('Visibility').isHidden()){c('Visibility').removeAllListeners();c('Visibility').once(c('Visibility').VISIBLE,this.$MessengerBotsQuickReplyButtonList14);}else this.$MessengerBotsQuickReplyButtonList14();}.bind(this),this.$MessengerBotsQuickReplyButtonList14=function(){var t=this.props,u=t.options,v=t.threadID;if(v){this.$MessengerBotsQuickReplyButtonList3=setTimeout(function(){c('OmniMActions').barTimedOut(v,u);this.$MessengerBotsQuickReplyButtonList3=null;c('Visibility').removeAllListeners();}.bind(this),c('MercuryConfig').OmniMSuggestionTTL);c('Visibility').removeAllListeners();c('Visibility').once(c('Visibility').HIDDEN,this.$MessengerBotsQuickReplyButtonList4);}}.bind(this),this.$MessengerBotsQuickReplyButtonList13=function(t){this.setState({previewItem:t});this.$MessengerBotsQuickReplyButtonList2=setTimeout(function(){return this.setState({showPreview:true});}.bind(this),c('MercuryConfig').OmniMPreviewDelay);return function(){if(this.state.previewItem===t){clearTimeout(this.$MessengerBotsQuickReplyButtonList2);this.setState({previewItem:null});}}.bind(this);}.bind(this),this.$MessengerBotsQuickReplyButtonList10=function(){var t=this.props.threadID;if(t)c('OmniMActions').suggestionsDismissedForThread(t);}.bind(this),this.$MessengerBotsQuickReplyButtonList11=function(){if(!c('MercuryConfig').OmniMDismissalDisabled)this.setState({showDismiss:true});}.bind(this),this.$MessengerBotsQuickReplyButtonList9=function(){this.setState({showDismiss:false});}.bind(this),this.$MessengerBotsQuickReplyButtonList15=function(){c('SimpleNUXMessage').markMessageSeenByUser(c('SimpleNUXMessageTypes').OMNIM_SUGGESTIONS);this.setState({nuxShown:false});}.bind(this),p;}m.prototype.componentDidMount=function(){if(this.props.source===c('MNOmniMConstants').OMNIM){this.props.options.map(function(o,p){return c('OmniMActions').suggestionDisplayed(o,p);});c('OmniMActions').barDisplayed(this.props.options);this.$MessengerBotsQuickReplyButtonList4();}this.$MessengerBotsQuickReplyButtonList5();};m.prototype.componentDidUpdate=function(o){var p=o.source===c('MNOmniMConstants').OMNIM?o.options:[],q=void 0;if(this.props.source===c('MNOmniMConstants').OMNIM){q=this.props.options;this.$MessengerBotsQuickReplyButtonList4();}else q=[];if(p.length||q.length)this.$MessengerBotsQuickReplyButtonList6(p,q);this.$MessengerBotsQuickReplyButtonList5();this.$MessengerBotsQuickReplyButtonList7(o,this.props);};m.prototype.componentWillUnmount=function(){if(this.props.source===c('MNOmniMConstants').OMNIM){this.props.options.map(function(o,p){return c('OmniMActions').suggestionDisappeared(o,p);});c('OmniMActions').barDisappeared(this.props.options);}clearTimeout(this.$MessengerBotsQuickReplyButtonList2);clearTimeout(this.$MessengerBotsQuickReplyButtonList3);};m.prototype.render=function(){var o=c('React').createElement(c('AdsArrowedCarouselEnhanced.react'),null,this.$MessengerBotsQuickReplyButtonList8());if(this.props.source===c('MNOmniMConstants').OMNIM){var p=c('MessengerEnvironment').messengerui,q=this.props.omniMPrefs,r=c('OmniMHelpers').suggestionMode(q),s=!c('MercuryConfig').OmniMLogoDisabled,t=c('React').createElement('div',{className:"_5fop"+(!p?' '+"_1nl8":'')+(this.state.showDismiss?' '+"_835":''),onMouseLeave:this.$MessengerBotsQuickReplyButtonList9},c('React').createElement(c('ShimButton.react'),{className:"_4yxa",onClick:this.$MessengerBotsQuickReplyButtonList10,title:i._("Dismiss all suggestions")}),c('React').createElement('div',{className:"_17in"+(r==1?' '+"_1ei7":'')+(r==2?' '+"_1eig":''),onMouseOver:this.$MessengerBotsQuickReplyButtonList11,ref:this.$MessengerBotsQuickReplyButtonList1}));return c('React').createElement('div',{className:'uiContextualLayerParent'},this.$MessengerBotsQuickReplyButtonList12(),c('React').createElement('div',{className:"_17im"+(!s?' '+"_2dfb":'')},c('React').createElement('div',{className:"_3-kc"+(this.state.showPreview?' '+"_3-kd":'')},this.state.previewItem),s?t:null,c('React').createElement('div',{className:"_17io"},o)));}return o;};m.prototype.$MessengerBotsQuickReplyButtonList8=function(){var o=this.props,p=o.options,q=o.source,r=c('MessengerEnvironment').messengerui;if(q===c('MNOmniMConstants').QUICKREPLIES)new (c('MessengerBotsWebTypedLogger'))().setEvent(c('MNBotsLoggerEvents').BOT_COMPOSER_QUICK_REPLY_DISPLAYED).setPageID(c('MercuryIDs').getUserIDFromThreadID(this.props.threadID)).log();return p.map(function(s,t){return c('React').createElement('div',{className:(r?"_1nl7":'')+(!r?' '+"_1nl8":''),key:t},c('React').createElement(c('MessengerBotsQuickReplyButtonContainer.react'),{option:s,threadID:this.props.threadID,index:t,source:q,setPreview:this.$MessengerBotsQuickReplyButtonList13}));}.bind(this));};m.prototype.$MessengerBotsQuickReplyButtonList12=function(){if(c('MercuryConfig').EnableOmniMNUX&&this.state.nuxShown){var o=c('MessengerEnvironment').messengerui;return c('React').createElement(c('XUIAmbientNUX.react'),{className:"_53zy",contextRef:function(){return this.refs[this.$MessengerBotsQuickReplyButtonList1];}.bind(this),shown:this.state.nuxShown,position:'above',width:'custom',customwidth:o?450:245,onCloseButtonClick:this.$MessengerBotsQuickReplyButtonList15},c('React').createElement('div',{className:"_53z_"},c('React').createElement('h1',{className:"_53-0"},'[FB-ONLY] Introducing M'),c('React').createElement('p',{className:"_53-b"},'M will now provide suggestions right in your conversation. Let us know when they aren\'t helpful so we can improve M.'),c('React').createElement('p',{className:"_53-c"},c('React').createElement(c('Link.react'),{onClick:this.$MessengerBotsQuickReplyButtonList15,target:'_blank',href:'https://fburl.com/omnim-nux'},'Learn How'))));}return null;};m.prototype.$MessengerBotsQuickReplyButtonList5=function(){if(this.props.source===c('MNOmniMConstants').OMNIM&&this.refs[this.$MessengerBotsQuickReplyButtonList1]){var o=!c('SimpleNUXMessage').hasUserSeenMessage(c('SimpleNUXMessageTypes').OMNIM_SUGGESTIONS);this.setState({nuxShown:o});}else if(this.state.nuxShown)this.setState({nuxShown:false});};m.prototype.$MessengerBotsQuickReplyButtonList7=function(o,p){if(o.threadID!==p.threadID){if(o.source===c('MNOmniMConstants').OMNIM)c('OmniMActions').barDisappeared(o.options);if(p.source===c('MNOmniMConstants').OMNIM)c('OmniMActions').barDisplayed(p.options);}};m.prototype.$MessengerBotsQuickReplyButtonList6=function(o,p){if(n(o.map(function(w){return w.suggestionID;}),p.map(function(w){return w.suggestionID;})))return;if(!o.length){p.map(function(w,x){return c('OmniMActions').suggestionDisplayed(w,x);});return;}if(!p.length){o.map(function(w,x){return c('OmniMActions').suggestionDisappeared(w,x);});return;}var q=c('immutable').Set(c('immutable').Range(0,p.length));for(var r=0;r<o.length;r++){var s=o[r],t=false;for(var u=0;u<p.length;u++){var v=p[u];if(s.suggestionID===v.suggestionID){if(r!==u)c('OmniMActions').suggestionDisplayed(v,u);t=true;q=q['delete'](u);break;}}if(!t)c('OmniMActions').suggestionDisappeared(s,r);}q.map(function(w){return c('OmniMActions').suggestionDisplayed(p[w],w);});};m.propTypes={options:l.array.isRequired,threadID:l.string,source:l.string.isRequired};function n(o,p){if(o.length!==p.length)return false;var q;for(q=0;q<o.length;q++)if(o[q]!==p[q])return false;return true;}f.exports=m;}),null);