if (self.CavalryLogger) { CavalryLogger.start_js(["apSz3"]); }

__d("MessagesViewerSetID",[],(function a(b,c,d,e,f,g){f.exports={MESSAGES:"messages",MESSAGES_VIEW_ALL_IN_THREAD:"messages:view_all_in_thread"};}),null);
__d('ChatSpeakingSticker.react',['React','ReactDOM'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').PureComponent);i=h&&h.prototype;function k(){var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=i.constructor).call.apply(l,[this].concat(o)),this.$ChatSpeakingSticker1=function(){var q=c('ReactDOM').findDOMNode(this.refs.stickerVideo);q.play();}.bind(this),m;}k.prototype.render=function(){return c('React').createElement('div',{onClick:this.$ChatSpeakingSticker1,role:'presentation'},c('React').createElement('video',{height:this.props.videoSize.height,ref:"stickerVideo",width:this.props.videoSize.width},c('React').createElement('source',{src:this.props.videoURI})));};k.propTypes={videoURI:j.string.isRequired,videoSize:j.shape({height:j.number,width:j.number}).isRequired};f.exports=k;}),null);
__d('MessagesViewer',['AsyncRequest','DOM','MessagesViewerSetID','PhotoStore','React','ReactDOM','emptyFunction','ge'],(function a(b,c,d,e,f,g){var h={renderSpotlight:function j(k,l,m,n){var o=k.setID;if(!o)o=c('MessagesViewerSetID').MESSAGES;i(c('React').createElement(m,{actorid:k.actorid,dimensions:[k.dimensions],disablepaging:k.disablePaging,disableForward:k.disableForward,forwardDialogComponent:n,open:true,photoid:k.fbid,reverse:false,rootClassName:k.rootClassName,setid:o,snapToPhoto:k.snapToPhoto,thumbsrc:k.src}));if(!c('PhotoStore').hasBeenCreated(o)&&k.endpoint){var p=new (c('AsyncRequest'))(k.endpoint);if(l)p.setRelativeTo(l);p.send();}},renderVideo:function j(k){i(k);}};function i(j){var k=c('ge')('messages_viewer');if(!k){k=c('DOM').create('div',{id:'messages_viewer'});document.body.appendChild(k);}c('ReactDOM').render(j,k,function(){this.subscribeOnce('close',function(){c('ReactDOM').unmountComponentAtNode(k);});});}f.exports=h;}),null);
__d('MessengerAttachmentViewer',['Bootloader','MessagesViewer','React','Run','emptyFunction'],(function a(b,c,d,e,f,g){'use strict';var h={renderVideo:function i(j){c('Bootloader').loadModules(["MessagingVideoViewer.react","messengerForwardAttachmentDialogReact"],function(k,l){var m=l.jsComponent;c('MessagesViewer').renderVideo(c('React').createElement(k,babelHelpers['extends']({},j,{forwardDialogComponent:m})));},'MessengerAttachmentViewer');},bootstrapWithConfig:function i(j,k){c('Bootloader').loadModules(["SpotlightMessagesViewer","messengerForwardAttachmentDialogReact"],function(l,m){var n=m.jsComponent;c('MessagesViewer').renderSpotlight(j,k,l,n);},'MessengerAttachmentViewer');},preload:function i(){c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["MessagingVideoViewer.react","SpotlightMessagesViewer","messengerForwardAttachmentDialogReact"],c('emptyFunction'),'MessengerAttachmentViewer');});}};f.exports=h;}),null);
__d('chatSpeakingStickerReact',['reasonReact','ChatSpeakingSticker.react'],(function a(b,c,d,e,f,g){'use strict';function h(i,j,k){return c('reasonReact').wrapJsForReason(c('ChatSpeakingSticker.react'),{videoURI:i,videoSize:j},k);}g.make=h;}),null);
__d('fBIDRe',['bs_string'],(function a(b,c,d,e,f,g){'use strict';var h=c('bs_string').compare;g.compare=h;}),null);
__d('mercuryAttachmentPayloadRe',[],(function a(b,c,d,e,f,g){'use strict';function h(i,j,k){var l=j?j[0]:null;return {app_attribution:null,attach_type:i,deduplication_key:null,description:null,icon_type:null,key:l,large_preview_height:null,large_preview_width:null,large_preview_url:null,media:null,metadata:null,name:null,preview_height:null,preview_uploading:null,preview_url:null,preview_width:null,rel:null,share:null,source:null,target:null,thumbnail_url:null,upload_id:null,uri:null,url:k,video_title:null};}g.create=h;}),null);
__d('randomShuffle',['randomInt'],(function a(b,c,d,e,f,g){function h(i){for(var j=i.length-1;j>0;j--){var k=c('randomInt').call(this,j+1);if(k!=j){var l=i[k];i[k]=i[j];i[j]=l;}}return i;}f.exports=h;}),null);
__d('MessagingFlowerCornerArrangements',['invariant','ix','Random','randomShuffle'],(function a(b,c,d,e,f,g,h,i){'use strict';var j={TOP_LEFT:'topLeft',BOTTOM_RIGHT:'bottomRight'},k={PINK:'pink',PURPLE:'purple',YELLOW:'yellow'},l={ROUND:'round',POINTY:'pointy'},m=-10;function n(r,s){this.$ElementProducer1=r;this.$ElementProducer4=s;this.$ElementProducer2=c('Random').random()<.5;this.$ElementProducer3=[];var t=[k.PINK,k.PURPLE,k.YELLOW],u=[l.ROUND,l.POINTY,c('Random').random()>=.5?l.ROUND:l.POINTY];c('randomShuffle')(t);c('randomShuffle')(u);for(var v=0;v<3;v++)this.$ElementProducer3.push(this.$ElementProducer5(t[v],u[v]));}n.prototype.$ElementProducer6=function(r){switch(r){case k.PINK:return i("86995");case k.PURPLE:return i("86997");case k.YELLOW:default:return i("86999");}};n.prototype.$ElementProducer7=function(r){switch(r){case k.PINK:return i("86996");case k.PURPLE:return i("86998");case k.YELLOW:default:return i("87000");}};n.prototype.$ElementProducer5=function(r,s){return s===l.POINTY?this.$ElementProducer6(r):this.$ElementProducer7(r);};n.prototype.$ElementProducer8=function(){return this.$ElementProducer3.pop();};n.prototype.flower=function(r){var s=c('Random').random()*360;return this.$ElementProducer9(this.$ElementProducer8(),{pivot:.5,rotationStart:s+r.rotationStartOffset,rotationEnd:s,scale:r.scale,x:r.x,y:r.y});};n.prototype.leaf=function(r){return this.$ElementProducer9(i("86994"),{pivot:1,rotationStart:0,rotationEnd:r.rotationEnd,scale:r.scale,x:r.x,y:r.y});};n.prototype.$ElementProducer9=function(r,s){var t=s.pivot*100+'%',u=s.x+m,v=s.y+m,w=-s.pivot*100,x=s.scale,y=s.rotationEnd,z=void 0,aa=void 0,ba=void 0,ca=void 0;if(this.$ElementProducer2){var da=u;u=v;v=da;y=-y;}if(this.$ElementProducer1===j.BOTTOM_RIGHT){ca=this.$ElementProducer4+u+'px';aa=this.$ElementProducer4+v+'px';w=100+w;y+=180;}else if(this.$ElementProducer1===j.TOP_LEFT){ba=this.$ElementProducer4+u+'px';z=this.$ElementProducer4+v+'px';}else h(0);var ea=[];if(w!==0)ea.push('translate('+w+'%, '+w+'%)');ea.push('scale('+x+')');if(y!==0)ea.push('rotate('+y+'deg)');return {style:{bottom:aa,left:ba,position:'absolute',right:ca,top:z,transform:ea.join(' '),transformOrigin:t+' '+t},image:r};};function o(r){return [r.leaf({x:20.5,y:38,scale:.225,rotationEnd:-80}),r.leaf({x:29,y:22.5,scale:.35,rotationEnd:35}),r.flower({x:31.5,y:22,scale:.6,rotationStartOffset:-70}),r.flower({x:21,y:35,scale:.65,rotationStartOffset:-70}),r.flower({x:21.75,y:24.75,scale:1,rotationStartOffset:50})];}function p(r){return [r.leaf({x:22.25,y:35.25,scale:.225,rotationEnd:-115}),r.leaf({x:35,y:24,scale:.35,rotationEnd:110}),r.flower({x:21.5,y:32.5,scale:.68,rotationStartOffset:-60}),r.flower({x:21.5,y:23.5,scale:.67,rotationStartOffset:-70}),r.flower({x:31,y:21,scale:.95,rotationStartOffset:50})];}function q(r,s){var t=new n(r,s);return c('Random').random()<.5?o(t):p(t);}f.exports={createFlowers:q,corners:j};}),null);
__d('MessagingFlowerBorder.react',['Image.react','MessagingFlowerCornerArrangements','React'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').PureComponent);i=h&&h.prototype;function k(){var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=i.constructor).call.apply(l,[this].concat(o)),this.$MessagingFlowerBorder1=function(){return c('MessagingFlowerCornerArrangements').createFlowers(c('MessagingFlowerCornerArrangements').corners.TOP_LEFT,this.props.offset).concat(c('MessagingFlowerCornerArrangements').createFlowers(c('MessagingFlowerCornerArrangements').corners.BOTTOM_RIGHT,this.props.offset));}.bind(this),this.state={elements:this.$MessagingFlowerBorder1()},m;}k.prototype.render=function(){return c('React').createElement('div',null,this.state.elements.map(function(l,m){return c('React').createElement(c('Image.react'),{key:m,style:l.style,src:l.image});}));};k.propTypes={ChildClass:j.number};k.defaultProps={offset:0};f.exports=k;}),null);
__d('messagingFlowerBorderReact',['reasonReact','MessagingFlowerBorder.react'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){return c('reasonReact').wrapJsForReason(c('MessagingFlowerBorder.react'),{offset:i},j);}g.make=h;}),null);
__d('MessagingGiftWrap.react',['cx','MessengerEnvironment','React','emptyFunction'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').PureComponent);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={unwrapped:false},this.$MessagingGiftWrap1=function(r){r.stopPropagation();this.setState({unwrapped:true});this.props.onUnwrap&&this.props.onUnwrap();}.bind(this),n;}l.prototype.render=function(){var m=c('MessengerEnvironment').messengerui;return c('React').createElement('div',{className:"_4p0m"+(this.state.unwrapped?' '+"_4p0o":'')+(m?' '+"_mxz":'')+(m?' '+"_4br2":'')+(!m?' '+"_3_om":'')+(this.props.isSticker?' '+"_52vq":''),onClick:this.$MessagingGiftWrap1,role:'presentation'},c('React').createElement('div',{className:"_4p0r"}),c('React').createElement('div',{className:"_4p0s _4p0t"}),c('React').createElement('div',{className:"_4p0s _4p0u"}));};l.propTypes={isSticker:k.bool,onUnwrap:k.func};l.defaultProps={onUnwrap:c('emptyFunction')};f.exports=l;}),null);
__d('messagingGiftWrapReact',['utilsRe','reasonReact','bs_js_null_undefined','MessagingGiftWrap.react'],(function a(b,c,d,e,f,g){'use strict';function h(i,j,k){return c('reasonReact').wrapJsForReason(c('MessagingGiftWrap.react'),{isSticker:c('utilsRe').optionBoolToNullUndefinedBoolean(i),onUnwrap:c('bs_js_null_undefined').from_opt(j)},k);}g.make=h;}),null);
__d('messengerPhotoReact',['cx','fbt','bs_curry','utilsRe','linkReact','imageReact','bs_js_boolean','bs_pervasives','reasonReact','joinClasses','bs_js_primitive','MercuryAttachmentType','messengerSpinnerReact','bs_caml_builtin_exceptions'],(function a(b,c,d,e,f,g,h,i){'use strict';function j(u,v){var w=u.metadata;if(c('bs_js_primitive').is_nil_undef(w)){return null;}else if(u.attach_type===c('MercuryAttachmentType').VIDEO){var x=v&&c('utilsRe').isDefined(w.large_preview);if(x!==0){return w.large_preview;}else return w.inbox_preview;}else if(v!==0){return u.large_preview_url;}else return u.preview_url;}function k(u){if(c('bs_js_primitive').is_nil_undef(u)){return [null,null];}else return [u.width,u.height];}function l(u){var v=+(window.screen.width>1800);if(c('utilsRe').isTruthy(u.preview_uploading)){var w=function ka(la,ma){var na=c('utilsRe').isDefined(la);if(na!==0){return la;}else return ma;},x=v&&c('utilsRe').isDefined(u.large_preview_url);if(x!==0){return [[w(u.large_preview_width,480),w(u.large_preview_height,480),u.large_preview_url,v]];}else return [[w(u.preview_width,280),w(u.preview_height,280),u.preview_url,v]];}else{var y=j(u,v),z=c('utilsRe').isDefined(y),aa=u.metadata,ba=0;if(z!==0){if(c('bs_js_primitive').is_nil_undef(aa)){ba=1;}else{var ca=v&&c('utilsRe').isDefined(aa.large_size),da=ca!==0?aa.large_size:aa.inbox_size,ea=k(da);return [[ea[0],ea[1],y,v]];}}else ba=1;if(ba===1)if(c('utilsRe').isDefined(u.preview_url)){var fa=v&&c('utilsRe').isDefined(u.large_preview_url);if(fa!==0){return [[u.large_preview_width,u.large_preview_height,u.large_preview_url,v]];}else return [[u.preview_width,u.preview_height,u.preview_url,v]];}else{var ga=u.media;if(c('bs_js_primitive').is_nil_undef(ga)){return 0;}else{var ha=c('utilsRe').isDefined(ga.playable)&&c('utilsRe').isDefined(ga.animated_image);if(ha!==0){var ia=k(ga.animated_image_size);return [[ia[0],ia[1],ga.animated_image,v]];}else{var ja=k(ga.image_size);return [[ja[0],ja[1],ga.image,v]];}}}}}function m(u){var v=function ca(da){return [""+(String(da)+"")];};if(c('utilsRe').isTruthy(u.preview_uploading)){var w=c('utilsRe').isDefined(u.preview_url);return v(w!==0?0:280);}else{var x=function ca(da){var ea=da[1],fa=da[0];if(!c('bs_js_primitive').is_nil_undef(fa)&&!c('bs_js_primitive').is_nil_undef(ea)){return [[fa,ea]];}else return 0;},y=function ca(da){if(da){var ea=da[0];return x([ea[0],ea[1]]);}else return 0;},z=c('utilsRe').isDefined(u.media),aa=z!==0?y(l(u)):x([u.preview_width,u.preview_height]);if(aa){var ba=aa[0];return v(c('bs_pervasives').min(ba[1]*c('bs_pervasives').min(1,450/ba[0]),450));}else return 0;}}function n(u,v,w,x,y){c('utilsRe').isTruthy(x.preview_uploading);var z=u[2];if(c('bs_js_primitive').is_nil_undef(z)){return null;}else if(y){var aa=u[3],ba=aa!==0?window.screen.height*.7:window.screen.height*.65,ca={maxHeight:""+(String(ba)+""),maxWidth:"100%",width:"100%"};return c('reasonReact').element(0,0,c('imageReact').make([c('joinClasses')(w,c('bs_js_boolean').to_js_boolean(1-v)?"_5pf5":'')],[""],[z],0,0,0,[ca],[]));}else return null;}var o=c('reasonReact').statelessComponent("MessengerPhoto");function p(u,v,w,x,y,z){var aa=u?u[0]:"",ba=o.slice();ba[4]=function(){if(x)c('bs_curry')._1(x[0],0);return 0;};ba[9]=function(){var ca=l(v);if(ca){var da=ca[0],ea=+(v.attach_type===c('MercuryAttachmentType').ANIMATED_IMAGE),fa=c('utilsRe').isDefined(v.app_attribution),ga=n(da,w&&ea,c('joinClasses')(c('bs_js_boolean').to_js_boolean(fa)?"_mxz":'',c('bs_js_boolean').to_js_boolean(w&&1-fa)?"_52mr":''),v,w),ha=1-ea||1-w,ia;if(ha!==0){var ja=da[2],ka=c('bs_js_primitive').is_nil_undef(ja)?0:["url("+(ja+")")],la=w!==0?m(v):0;ia=[ka,la];}else ia=[0,0];var ma={backgroundImage:c('bs_js_primitive').option_get(ia[0]),minHeight:c('bs_js_primitive').option_get(ia[1])},na=c('utilsRe').isTruthy(v.preview_uploading),oa=na!==0?c('reasonReact').element(0,0,c('messengerSpinnerReact').make(0,0,0,[])):null,pa=ea!==0?[c('MercuryAttachmentType').ANIMATED_IMAGE]:0,qa=function ra(sa){sa.preventDefault();if(y){return c('bs_curry')._1(y[0],v);}else return 0;};return c('reasonReact').createDomElement("div",{className:c('joinClasses')(aa,"_4tsk",c('bs_js_boolean').to_js_boolean(fa)?"_mxz":'',c('bs_js_boolean').to_js_boolean(w&&1-fa)?"_52mr":'',c('bs_js_boolean').to_js_boolean(c('utilsRe').isTruthy(v.preview_uploading)&&1-c('utilsRe').isDefined(da[2]))?"_3etv":''),"data-testid":pa,onClick:qa,role:"presentation",style:ma},[ga,oa,c('reasonReact').element(0,0,c('linkReact').make([i._("Open Photo")],["_4tsl"],0,0,c('bs_js_primitive').null_undefined_to_opt(da[2]),0,0,0,0,0,0,0,0,[z]))]);}else return null;};return ba;}var q=280,r=480,s=1800,t=450;g.preview_thumbnail_size=q;g.preview_large_size=r;g.large_window_width=s;g.max_photo_width=t;g.getSrcFromAttachment=j;g.sizeToWidthHeight=k;g.extractPreviewMetadata=l;g.getMinHeightForAttachment=m;g.getImageFromMetadata=n;g.component=o;g.make=p;}),null);
__d('MessengerSharedMediaReducer',['MessengerSharedMediaActions','MessengerThreadSharedMediaHelper','Set'],(function a(b,c,d,e,f,g){'use strict';var h=c('MessengerSharedMediaActions').Types;function i(s,t){switch(t.type){case h.LOAD_CURRENT:var u=s.get('sharedMedia').get(t.threadFBID);if(u){var v=u.edges.find(function(y){return y.node.legacy_attachment_id===t.photoID;});if(v)return s;}var w=s.get('isLoading').get(t.threadFBID);if(!!w&&w.curr)return s;var x=q(s,t.threadFBID,'curr',true);c('MessengerThreadSharedMediaHelper').search(t.threadFBID,t.photoID,function(y){return c('MessengerSharedMediaActions').currentLoaded(y);});return x;}return s;}function j(s,t){switch(t.type){case h.LOAD_MORE_PREVIOUS:var u=s.get('isLoading').get(t.threadFBID);if(!!u&&u.prev)return s;var v=q(s,t.threadFBID,'prev',true);if(v===null)return s;c('MessengerThreadSharedMediaHelper').loadMorePrevious(t.threadFBID,t.afterCursor,t.first,function(w){return c('MessengerSharedMediaActions').previousLoaded(w);});return v;}return s;}function k(s,t){switch(t.type){case h.LOAD_MORE_LATEST:var u=s.get('isLoading').get(t.threadFBID);if(!!u&&u.latest)return s;var v=q(s,t.threadFBID,'latest',true);if(v===null)return s;c('MessengerThreadSharedMediaHelper').loadMoreLatest(t.threadFBID,t.beforeCursor,t.last,function(w){return c('MessengerSharedMediaActions').latestLoaded(w);});return v;}return s;}function l(s,t){switch(t.type){case h.CURRENT_LOADED:var u=t.data,v=Object.keys(u)[0],w=u[v].message_shared_media,x=w.edges.length,y=q(s,v,'curr',false);if(x!==0){var z=p(s.get('sharedMedia').get(v),w,0),aa=s.get('sharedMedia').set(v,z);y=y.set('sharedMedia',aa);var ba=w.edges[0];c('MessengerThreadSharedMediaHelper').loadMorePrevious(v,ba.cursor,10,function(ca){return c('MessengerSharedMediaActions').previousLoaded(ca);});c('MessengerThreadSharedMediaHelper').loadMoreLatest(v,ba.cursor,10,function(ca){return c('MessengerSharedMediaActions').latestLoaded(ca);});}return y;}return s;}function m(s,t){switch(t.type){case h.PREVIOUS_LOADED:var u=t.data,v=Object.keys(u)[0],w=u[v].message_shared_media,x=q(s,v,'prev',false),y=p(s.get('sharedMedia').get(v),w,1),z=s.get('sharedMedia').set(v,y);x=x.set('sharedMedia',z);return x;}return s;}function n(s,t){switch(t.type){case h.LATEST_LOADED:var u=t.data,v=Object.keys(u)[0],w=u[v].message_shared_media,x=q(s,v,'latest',false),y=p(s.get('sharedMedia').get(v),w,-1),z=s.get('sharedMedia').set(v,y);x=x.set('sharedMedia',z);return x;}return s;}function o(s,t){switch(t.type){case h.DELETE_PHOTOS:var u=t.threadFBID,v=t.photoFBIDs,w=s.get('sharedMedia').get(u),x=new (c('Set'))(v.map(function(aa){return aa.toString();}));w.edges=w.edges.filter(function(aa){return !x.has(aa.node.legacy_attachment_id);});var y=s.get('sharedMedia').set(u,w),z=s.set('sharedMedia',y);return z;}return s;}function p(s,t,u){var v={};v.count=t.count;if(u===1&&s){var w=s.edges;v.has_previous_page=s.has_previous_page;v.has_next_page=t.page_info.has_next_page;if(t.edges.length>0){v.edges=w.concat(t.edges);}else v.edges=w;}else if(u===-1&&s){var x=s.edges;v.has_previous_page=t.page_info.has_previous_page;v.has_next_page=s.has_next_page;if(t.edges.length>0){v.edges=t.edges.concat(x);}else v.edges=x;}else{v.has_previous_page=t.page_info.has_previous_page;v.has_next_page=t.page_info.has_next_page;if(t.edges.length>0)v.edges=t.edges;}return v;}function q(s,t,u,v){var w=s.get('isLoading').get(t);if(w===undefined){w={};w[u]=v;}else w[u]=v;var x=s.set('isLoading',s.get('isLoading').set(t,w));return x;}var r={currentLoaded:l,deletePhotos:o,latestLoaded:n,loadCurrent:i,loadMoreLatest:k,loadMorePrevious:j,previousLoaded:m};f.exports=r;}),null);
__d('MessengerSharedMediaState',['immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={sharedMedia:c('immutable').Map({}),isLoading:c('immutable').Map({})};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments);}f.exports=k;}),null);
__d('MessengerSharedMediaStore',['MessengerFluxReduceDispatcher','MessengerSharedMediaActions','MessengerSharedMediaReducer','MessengerSharedMediaState','FluxReduceStore'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=Object.keys(c('MessengerSharedMediaReducer'));h=babelHelpers.inherits(k,c('FluxReduceStore'));i=h&&h.prototype;k.prototype.getInitialState=function(){return new (c('MessengerSharedMediaState'))();};k.prototype.reduce=function(l,m){if(m.namespace!==c('MessengerSharedMediaActions').Namespace)return l;j.forEach(function(n){l=c('MessengerSharedMediaReducer')[n](l,m);});return l;};function k(){h.apply(this,arguments);}f.exports=new k(c('MessengerFluxReduceDispatcher'));}),null);
__d('messengerSharedPhotosAlbumViewPhotoReact',['bs_curry','React','reasonReact'],(function a(b,c,d,e,f,g){'use strict';var h=c('reasonReact').statelessComponent("MessengerSharedPhotosAlbumViewPhotoReact");function i(j,k,l,m,n){var o=h.slice();o[9]=function(){return c('React').createElement("a",{className:j,style:{backgroundImage:"url("+(m+")")},href:"#",onClick:function p(){return c('bs_curry')._1(l,k);}});};return o;}g.component=h;g.make=i;}),null);
__d('messengerSharedPhotosAlbumViewVScrollReact',['cx','bs_array','bs_block','bs_curry','React','ReactDOM','Animation','bs_caml_array','reasonReact','bs_caml_builtin_exceptions','MessengerSharedMediaActions','messengerSharedPhotosAlbumViewPhotoReact'],(function a(b,c,d,e,f,g,h){'use strict';function i(ca){var da=ca[1],ea=da.length;if(ea<48){c('MessengerSharedMediaActions').loadMorePrevious(ca[0],c('bs_caml_array').caml_array_get(da,da.length-1|0).cursor,48);return 0;}else return 0;}function j(ca){if(ca){var da=ca[0];return +((da.scrollTop+da.clientHeight|0)>=(da.scrollHeight-20|0));}else throw c('bs_caml_builtin_exceptions').not_found;}function k(ca){if(ca){return +(ca[0].scrollTop<=20);}else throw c('bs_caml_builtin_exceptions').not_found;}function l(ca){if(ca){return ca[0].clientHeight;}else throw c('bs_caml_builtin_exceptions').not_found;}function m(ca,da){if(ca){new (c('Animation'))(ca[0]).to("scrollTop",da).duration(200).go();return 0;}else return 0;}function n(ca){var da=ca[2];if(da){return m(ca[1],c('ReactDOM').findDOMNode(da[0]).offsetTop-70|0);}else return 0;}function o(ca,da){var ea=da[4],fa=ea[3],ga=ea[1],ha=ea[0],ia=da[3],ja=ga.length;if(j(ia[1])){if(ja<ea[2]&&!fa.prev){c('MessengerSharedMediaActions').loadMorePrevious(ha,c('bs_caml_array').caml_array_get(ga,ga.length-1|0).cursor,48);return 0;}else return 0;}else if(k(ia[1])&&!fa.latest){c('MessengerSharedMediaActions').loadMoreLatest(ha,c('bs_caml_array').caml_array_get(ga,0).cursor,48);return 0;}else return 0;}function p(ca){var da=ca[3];i(ca[4]);var ea=da[1],fa;if(ea){var ga=c('bs_curry')._1(ca[1],o);ea[0].addEventListener("scroll",ga);fa=[ga];}else fa=0;var ha=function ia(ja,ka){var la=ka[3];if(l(la[3])>0){n(la);var ma=la[0];if(ma){clearInterval(ma[0]);return c('bs_block').__(1,[[0,la[1],la[2],la[3],la[4]]]);}else return 0;}else return 0;};return c('bs_block').__(0,[[[setInterval(c('bs_curry')._1(ca[2],ha),200)],da[1],da[2],da[3],fa]]);}function q(ca){var da=ca[3],ea=da[1],fa=da[4];if(ea)if(fa)ea[0].removeEventListener("scroll",fa[0]);var ga=da[0];if(ga){clearInterval(ga[0]);return 0;}else return 0;}var r=c('reasonReact').statefulComponentWithRetainedProps("MessengerSharedPhotosAlbumViewVScrollReact");function s(ca,da){da[3][1]=ca===null?0:[ca];return 0;}function t(ca,da){da[3][3]=ca===null?0:[ca];return 0;}function u(ca,da){da[3][2]=ca===null?0:[ca];return 0;}function v(ca,da,ea,fa,ga,ha,ia){var ja=function ka(la){return c('bs_array').map(function(ma){var na=ma.node,oa=+(na.legacy_attachment_id===ha);return c('reasonReact').element([na.legacy_attachment_id],oa!==0?[c('bs_curry')._1(la[1],u)]:0,c('messengerSharedPhotosAlbumViewPhotoReact').make("_3bly",na.legacy_attachment_id,da,na.image1.uri,[]));},ea);};return [r[0],r[1],r[2],r[3],p,r[5],q,r[7],r[8],function(ka){return c('React').createElement("div",{ref:c('bs_curry')._1(ka[1],s),className:"_3xo8",onScroll:c('bs_curry')._1(ka[1],o)},c('React').createElement("div",{ref:c('bs_curry')._1(ka[1],t),className:"_3xoa"},ja(ka)));},function(){return [0,0,0,0,0];},r[11],[fa,ea,ga,ca]];}var w=c('reasonReact').wrapReasonForJs(r,function(ca){return v(ca.isLoading,ca.onClick,ca.sharedPhotos,ca.threadID,ca.totalCount,ca.viewedPhoto,[]);}),x=200,y=48,z=6,aa=20,ba=70;g.animationDuration=x;g.imagesToLoad=y;g.photosPerRow=z;g.scrollToEdgeTolerance=aa;g.headerHeight=ba;g.graduallyLoadPhotos=i;g.isScrolledToBottom=j;g.isScrolledToTop=k;g.getScrollHeight=l;g.scrollTo=m;g.autoScrollWhenLoaded=n;g.handleScroll=o;g.didMount=p;g.willUnmount=q;g.component=r;g.setRefChildContainer=s;g.setRefScrollable=t;g.setRefChild=u;g.make=v;g.jsComponent=w;}),null);
__d('MessengerSharedPhotosAlbumView.react',['cx','fbt','messengerSharedPhotosAlbumViewVScrollReact','MessengerPhotoViewCloseLink.react','React','ShimButton.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('messengerSharedPhotosAlbumViewVScrollReact').jsComponent,m=c('React').PropTypes;j=babelHelpers.inherits(n,c('React').Component);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.$MessengerSharedPhotosAlbumView2=function(){this.props.onClick(this.props.viewedPhoto);}.bind(this),this.$MessengerSharedPhotosAlbumView1=function(){return c('React').createElement('div',{className:"_3bm0 _5l-3",ref:'header'},c('React').createElement(c('ShimButton.react'),{className:"_3bm2",onClick:this.$MessengerSharedPhotosAlbumView2},c('React').createElement('div',{className:"_3bm3"}),i._("Back to photo")),c('React').createElement('div',{className:"_3bm4"},i._("Shared Photos")),c('React').createElement(c('MessengerPhotoViewCloseLink.react'),{onClick:this.props.onCloseSharedPhotos}));}.bind(this),p;}n.prototype.render=function(){return c('React').createElement('div',{className:"_3bl- _5l-3",ref:'window'},this.$MessengerSharedPhotosAlbumView1(),c('React').createElement(l,{isLoading:this.props.isLoading,onClick:this.props.onClick,sharedPhotos:this.props.sharedPhotos,threadID:this.props.threadID,totalCount:this.props.totalCount,viewedPhoto:this.props.viewedPhoto}));};n.propTypes={onClick:m.func.isRequired,onCloseSharedPhotos:m.func.isRequired,sharedPhotos:m.arrayOf(m.object).isRequired,totalCount:m.number.isRequired,viewedPhoto:m.string.isRequired,threadID:m.string.isRequired,isLoading:m.object.isRequired};f.exports=n;}),null);
__d('MessengerSharedPhotosAlbumViewContainer.react',['FluxContainer','MessengerSharedMediaStore','React','MessengerSharedPhotosAlbumView.react'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').PureComponent);i=h&&h.prototype;function k(){var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=i.constructor).call.apply(l,[this].concat(o)),this.state={edges:[],count:0,isLoading:{}},m;}k.getStores=function(){return [c('MessengerSharedMediaStore')];};k.calculateState=function(l,m){var n=c('MessengerSharedMediaStore').getState(),o=n.sharedMedia;return {edges:o.get(m.threadID).edges,count:o.get(m.threadID).count,isLoading:n.isLoading.get(m.threadID)};};k.prototype.render=function(){if(this.state.edges.length===0)return null;return c('React').createElement(c('MessengerSharedPhotosAlbumView.react'),{onClick:this.props.onClick,onCloseSharedPhotos:this.props.onCloseSharedPhotos,sharedPhotos:this.state.edges,totalCount:this.state.count,viewedPhoto:this.props.viewedPhoto,threadID:this.props.threadID,isLoading:this.state.isLoading});};k.propTypes={onClick:j.func.isRequired,onCloseSharedPhotos:j.func.isRequired,viewedPhoto:j.string.isRequired,threadID:j.string};f.exports=c('FluxContainer').create(k,{withProps:true});}),null);
__d('MessengerPhotoViewBottomBar.react',['cx','React'],(function a(b,c,d,e,f,g,h){'use strict';var i=function j(k){return c('React').createElement('div',{className:"_51an _50-m _16zz"},k.children);};f.exports=i;}),null);
__d('MessengerPhotoViewHScroll.react',['cx','Animation','MessengerSharedPhoto.react','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes,l=200,m=80;i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=j.constructor).call.apply(o,[this].concat(r)),this.$MessengerPhotoViewHScroll1=null,p;}n.prototype.componentDidMount=function(){this.$MessengerPhotoViewHScroll2();};n.prototype.componentDidUpdate=function(){this.$MessengerPhotoViewHScroll2();};n.prototype.componentWillUnmount=function(){this.$MessengerPhotoViewHScroll1&&this.$MessengerPhotoViewHScroll1.stop();this.$MessengerPhotoViewHScroll1=null;};n.prototype.render=function(){var o=this.props.sharedPhotos,p=o.reduce(function(r,s){var t=s.node.image1===null?s.node.image:s.node.image1;if(t)r.push(c('React').createElement('div',{className:"_4dy9",key:s.node.legacy_attachment_id},c('React').createElement(c('MessengerSharedPhoto.react'),{className:"_42rl"+(this.props.photoID!==s.node.legacy_attachment_id?' '+"_q1a":''),fbid:s.node.legacy_attachment_id,onClick:this.props.onScroll,uri:t.uri})));return r;}.bind(this),[]),q=(this.props.width-m)/2;return c('React').createElement('div',{className:"_463g"},c('React').createElement('div',{className:"_463h",ref:'childContainer'},c('React').createElement('div',{className:"_463j",style:{paddingLeft:q,paddingRight:q},ref:'scrollable'},p)));};n.prototype.$MessengerPhotoViewHScroll2=function(){var o=this.refs.childContainer?this.refs.childContainer.scrollLeft:0,p=this.props.sharedPhotos.findIndex(function(r){return r.node.legacy_attachment_id===this.props.photoID;}.bind(this)),q=p*m;if(!this.$MessengerPhotoViewHScroll1)this.$MessengerPhotoViewHScroll1=new (c('Animation'))(this.refs.childContainer);this.$MessengerPhotoViewHScroll1.from('scrollLeft',o).to('scrollLeft',q).duration(l).go();};f.exports=n;}),null);
__d('MessengerPhotoViewHeader.react',['cx','fbt','MessagingForwardingButtonNUX.react','MessengerActions','MessengerPhotoInfoDialogContainer.react','React','SpotlightViewerBottomBarLink','MessengerPhotoViewCloseLink.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').PureComponent);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.$MessengerPhotoViewHeader3=function(){if(this.refs.forwardNUX)this.refs.forwardNUX.close();this.props.showForwardDialog&&this.props.showForwardDialog();}.bind(this),this.$MessengerPhotoViewHeader2=function(){return c('React').createElement(c('MessengerPhotoViewCloseLink.react'),{onClick:this.props.onClose});}.bind(this),o;}m.prototype.render=function(){return c('React').createElement('div',{className:"_51an _50-m _3c1i _5l-3",role:'banner'},this.$MessengerPhotoViewHeader1(),this.$MessengerPhotoViewHeader2());};m.prototype.$MessengerPhotoViewHeader1=function(){var n=void 0,o=void 0;if(!this.props.disableForward){n=c('React').createElement(c('SpotlightViewerBottomBarLink'),{className:"_3c1o",onClick:this.$MessengerPhotoViewHeader3,ref:'forwardButton'},c('React').createElement('div',{className:"_2msr _3oo2"}),i._("Forward"));o=c('React').createElement(c('MessagingForwardingButtonNUX.react'),{contextRef:function(){return this.refs.forwardButton;}.bind(this),ref:'forwardNUX'},i._("Send this image to other people in separate messages."));}return c('React').createElement('div',{key:'buttonsContainer',ref:'buttons'},c('React').createElement(c('SpotlightViewerBottomBarLink'),{ajaxify:this.props.url,className:"_3c1o",rel:'async'},c('React').createElement('div',{className:"_3ooo _2msr"}),i._("Download")),n,o,c('React').createElement(c('SpotlightViewerBottomBarLink'),{className:"_3c1o",href:'#',onClick:this.props.openInfo,ref:'moreInfo'},c('React').createElement('div',{className:"_3c1k _2msr"}),i._("Info")));};m.propTypes={disableForward:l.bool,onClose:l.func,openInfo:l.func,photoID:l.string,showForwardDialog:l.func,url:l.object};f.exports=m;}),null);
__d('SpotlightMessengerSharedMediaViewer.react',['csx','cx','fbt','invariant','ActorURI','MessengerPhotoViewHScroll.react','Event','KeyEventController','messengerForwardAttachmentDialogReact','MessengerPhotoInfoDialogContainer.react','MessengerPhotoViewHeader.react','MessengerSharedMediaActions','MessengerVideoPlayer.react','Parent','PhotoUtils','React','SpotlightViewer','SpotlightViewerImage','SpotlightMessagesViewerPagers.react','SpotlightViewport','SubscriptionsHandler','Vector','XMessagingPhotoDownloadController','MessengerPhotoViewBottomBar.react'],(function a(b,c,d,e,f,g,h,i,j,k){'use strict';var l,m,n=c('messengerForwardAttachmentDialogReact').jsComponent,o=c('React').PropTypes,p=88,q=80,r=30,s="_4-og";l=babelHelpers.inherits(t,c('React').Component);m=l&&l.prototype;function t(){var u,v;for(var w=arguments.length,x=Array(w),y=0;y<w;y++)x[y]=arguments[y];return v=(u=m.constructor).call.apply(u,[this].concat(x)),this.$SpotlightMessengerSharedMediaViewer1=undefined,this.$SpotlightMessengerSharedMediaViewer2=[],this.state={photoData:null,showForward:false,showInfo:false,stageDimensions:new (c('Vector'))()},this.$SpotlightMessengerSharedMediaViewer14=function(z){if(!this.props.sharedMedia)return;var aa=this.props.sharedMedia.findIndex(function(ca){return ca.node.legacy_attachment_id===z;});if(aa<0)return;var ba=this.props.sharedMedia[aa];this.setState({photoData:ba});this.$SpotlightMessengerSharedMediaViewer17(aa);}.bind(this),this.$SpotlightMessengerSharedMediaViewer4=function(z,event){if(this.state.photoData==null)return;var aa=this.state.photoData;if(event&&!!c('Parent').bySelector(event.target,"._3tsq"))return;if(event&&event.target instanceof HTMLElement&&event.target.className===s)this.$SpotlightMessengerSharedMediaViewer7();var ba=this.props.sharedMedia.findIndex(function(da){return da.node.legacy_attachment_id===aa.node.legacy_attachment_id;});if(ba<0||ba===this.props.sharedMedia.length-1&&!this.props.hasNextPage&&z)return;if(ba===0&&!z){c('MessengerSharedMediaActions').loadMoreLatest(this.props.threadID,this.props.sharedMedia[0].cursor,r);return;}var ca=z?this.props.sharedMedia[ba+1]:this.props.sharedMedia[ba-1];this.setState({photoData:ca});this.$SpotlightMessengerSharedMediaViewer17(ba);}.bind(this),this.$SpotlightMessengerSharedMediaViewer7=function(){if(this.props.photoID===null)return;this.setState({photoData:null});this.props.onClosePhotoView();}.bind(this),this.$SpotlightMessengerSharedMediaViewer12=function(){this.setState({showForward:true});}.bind(this),this.$SpotlightMessengerSharedMediaViewer15=function(){this.setState({showForward:false});}.bind(this),this.$SpotlightMessengerSharedMediaViewer11=function(){this.setState({showInfo:true});}.bind(this),this.$SpotlightMessengerSharedMediaViewer16=function(){this.setState({showInfo:false});}.bind(this),v;}t.prototype.componentDidMount=function(){var u=this.props.sharedMedia.find(function(v){return v.node.legacy_attachment_id===this.props.photoID;}.bind(this));this.setState({photoData:u,stageDimensions:this.$SpotlightMessengerSharedMediaViewer3()});this.$SpotlightMessengerSharedMediaViewer1=new (c('SubscriptionsHandler'))();this.$SpotlightMessengerSharedMediaViewer1.addSubscriptions(c('Event').listen(window,'resize',function(){this.setState({stageDimensions:this.$SpotlightMessengerSharedMediaViewer3()});}.bind(this)),c('KeyEventController').registerKey('LEFT',function(){this.$SpotlightMessengerSharedMediaViewer4(false);return false;}.bind(this)),c('KeyEventController').registerKey('RIGHT',function(){this.$SpotlightMessengerSharedMediaViewer4(true);return false;}.bind(this)));};t.prototype.componentWillUnmount=function(){this.$SpotlightMessengerSharedMediaViewer1&&this.$SpotlightMessengerSharedMediaViewer1.release();this.$SpotlightMessengerSharedMediaViewer1=null;this.$SpotlightMessengerSharedMediaViewer2.forEach(function(u){return u.abandon();});};t.prototype.render=function(){var u=this.$SpotlightMessengerSharedMediaViewer5(),v=this.state.stageDimensions,w=this.props.useloadingindicator&&!this.state.photoData;if(this.state.photoData==null)return null;var x=this.props.sharedMedia.findIndex(function(z){this.state.photoData!=null||k(0);return z.node.id===this.state.photoData.node.id;}.bind(this)),y=c('React').createElement('div',null,this.$SpotlightMessengerSharedMediaViewer6(),this.props.disablepaging?null:c('React').createElement(c('SpotlightMessagesViewerPagers.react'),{disablePrevArrow:x<=0&&!this.props.hasPrevPage,disableNextArrow:!this.props.hasNextPage&&x>=this.props.sharedMedia.length-1}));return c('React').createElement('span',null,c('React').createElement(c('SpotlightViewer'),{className:"_53vs",onHide:this.$SpotlightMessengerSharedMediaViewer7,open:this.props.photoID!==null,ref:'spotlightViewer',rootClassName:this.props.rootClassName},c('React').createElement(c('SpotlightViewport'),{active:false,fadeInNOut:true,media:u,onClick:this.$SpotlightMessengerSharedMediaViewer4,ref:'viewport',showLoadingIndicator:w,stageDimensions:v,useWidth:true},y),this.$SpotlightMessengerSharedMediaViewer8()),this.$SpotlightMessengerSharedMediaViewer9(),this.$SpotlightMessengerSharedMediaViewer10());};t.prototype.$SpotlightMessengerSharedMediaViewer6=function(){if(!this.state.photoData)return null;var u=this.state.photoData.node.legacy_attachment_id,v=c('XMessagingPhotoDownloadController').getURIBuilder().setString('photo_id',u).getURI();if(this.props.actorid)v=c('ActorURI').create(v,this.props.actorid);return c('React').createElement(c('MessengerPhotoViewHeader.react'),{disableForward:this.props.disableForward,onClose:this.$SpotlightMessengerSharedMediaViewer7,openInfo:this.$SpotlightMessengerSharedMediaViewer11,photoID:this.props.photoID,ref:'photoviewheader',showForwardDialog:this.$SpotlightMessengerSharedMediaViewer12,url:v});};t.prototype.$SpotlightMessengerSharedMediaViewer13=function(u){return u?Math.ceil(u/q):r;};t.prototype.$SpotlightMessengerSharedMediaViewer8=function(){if(!this.state.photoData)return null;var u=this.state.photoData,v=c('React').createElement('button',{className:"_2n5b",onClick:function(){return this.props.openAlbum(u.node.legacy_attachment_id);}.bind(this),type:'button'},c('React').createElement('div',{className:"_3por"}));return c('React').createElement(c('MessengerPhotoViewBottomBar.react'),null,c('React').createElement(c('MessengerPhotoViewHScroll.react'),{onScroll:this.$SpotlightMessengerSharedMediaViewer14,photoID:u.node.legacy_attachment_id,sharedPhotos:this.props.sharedMedia,width:this.state.stageDimensions.x}),v);};t.prototype.$SpotlightMessengerSharedMediaViewer9=function(){if(!this.state.photoData||this.props.disableForward)return null;var u=j._("Forward in separate messages");return c('React').createElement(n,{attachmentID:this.state.photoData.node.legacy_attachment_id,onClose:this.$SpotlightMessengerSharedMediaViewer15,shown:this.state.showForward,title:u});};t.prototype.$SpotlightMessengerSharedMediaViewer10=function(){return this.state.showInfo?c('React').createElement(c('MessengerPhotoInfoDialogContainer.react'),{closeInfo:this.$SpotlightMessengerSharedMediaViewer16,infoOpen:this.state.showInfo,photoID:this.state.photoData.node.id}):c('React').createElement('xhp',null);};t.prototype.$SpotlightMessengerSharedMediaViewer17=function(u){var v=this.$SpotlightMessengerSharedMediaViewer13(this.state.stageDimensions.x),w=this.props.sharedMedia;if(u<=v/2){c('MessengerSharedMediaActions').loadMoreLatest(this.props.threadID,w[0].cursor,v);if(w.length<v&&this.props.hasNextPage)c('MessengerSharedMediaActions').loadMorePrevious(this.props.threadID,w[w.length-1].cursor,v);}else if(u>=w.length-v/2&&this.props.hasNextPage)c('MessengerSharedMediaActions').loadMorePrevious(this.props.threadID,w[w.length-1].cursor,v);};t.prototype.$SpotlightMessengerSharedMediaViewer3=function(){var u=new (c('Vector'))(c('Vector').getViewportDimensions().x,c('Vector').getViewportDimensions().y-p);return u;};t.prototype.$SpotlightMessengerSharedMediaViewer5=function(){if(this.state.photoData&&this.state.photoData.node){var u=this.state.photoData.node;if(u.__typename&&u.__typename==='MessageVideo')return this.$SpotlightMessengerSharedMediaViewer18();var v=this.state.stageDimensions,w=this.$SpotlightMessengerSharedMediaViewer19(u,v);if(!w)return null;var x=t.getImageDimensionsForStage(new (c('Vector'))(w.width,w.height),v);return this.$SpotlightMessengerSharedMediaViewer20(w,x);}else return null;};t.prototype.$SpotlightMessengerSharedMediaViewer18=function(){if(this.state.photoData)return c('React').createElement(c('MessengerVideoPlayer.react'),{isVisible:true,isOnStage:true,videoData:this.state.photoData.node,stageDimensions:this.state.stageDimensions});return null;};t.prototype.$SpotlightMessengerSharedMediaViewer20=function(u,v){return c('React').createElement(c('SpotlightViewerImage'),{dimensions:v,ref:'image',src:u.uri});};t.prototype.$SpotlightMessengerSharedMediaViewer19=function(u,v){var w=null,x=c('PhotoUtils').getImagesFromData(u);x=x.sort(function(z,aa){return aa.width-z.width;});if(window.devicePixelRatio&&window.devicePixelRatio>1)v=new (c('Vector'))(v.x*window.devicePixelRatio,v.y*window.devicePixelRatio);for(var y=0;y<x.length;y++)if(!w||x[y].width>=v.x||x[y].height>=v.y)w=x[y];return w;};t.propTypes={disableForward:o.bool,hasPrevPage:o.bool,hasNextPage:o.bool,onClosePhotoView:o.func,openAlbum:o.func,photoID:o.string,rootClassName:o.string,threadID:o.string,sharedMedia:o.arrayOf(o.object)};t.getImageDimensionsForStage=function(u,v){var w=u.x,x=u.y,y=v.x,z=v.y,aa=w/x,ba=y/z;if(w>=y||x>=z){if(ba<aa){w=y;x=Math.round(y/aa);}else if(ba>aa){w=Math.round(z*aa);x=z;}else{w=y;x=z;}}else if(aa<ba){w=Math.round(x*aa);}else x=Math.round(w/aa);return new (c('Vector'))(w,x);};f.exports=t;}),null);
__d('SpotlightMessengerSharedMediaViewerContainer.react',['FluxContainer','MessengerSharedMediaStore','MessengerSharedMediaActions','React','SpotlightMessengerSharedMediaViewer.react'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('React').PureComponent);i=h&&h.prototype;j.getStores=function(){return [c('MessengerSharedMediaStore')];};j.calculateState=function(k,l){var m=c('MessengerSharedMediaStore').getState(),n=m.sharedMedia.get(l.threadID),o=m.isLoading.get(l.threadID);return {sharedMedia:n,isLoading:o};};j.prototype.componentDidMount=function(){c('MessengerSharedMediaActions').loadCurrent(this.props.threadID,this.props.photoID);};j.prototype.render=function(){if(!this.state.sharedMedia)return null;var k=this.state.sharedMedia&&this.state.sharedMedia.edges.find(function(l){return l.node.legacy_attachment_id===this.props.photoID;}.bind(this));if(!k)return null;return c('React').createElement(c('SpotlightMessengerSharedMediaViewer.react'),{disableForward:this.props.disableForward,hasPrevPage:this.state.sharedMedia&&this.state.sharedMedia.has_previous_page,hasNextPage:this.state.sharedMedia&&this.state.sharedMedia.has_next_page,onClosePhotoView:this.props.onClosePhotoView,openAlbum:this.props.openAlbum,photoID:this.props.photoID,rootClassName:this.props.rootClassName,sharedMedia:this.state.sharedMedia&&this.state.sharedMedia.edges,threadID:this.props.threadID});};function j(){h.apply(this,arguments);}f.exports=c('FluxContainer').create(j,{withProps:true});}),null);
__d('MessengerThreadSharedPhotos.react',['cx','MessengerSharedPhotosAlbumViewContainer.react','React','SpotlightViewer','SpotlightMessengerSharedMediaViewerContainer.react'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={photoView:this.props.findFBID,albumView:''},this.$MessengerThreadSharedPhotos3=function(r){this.setState({albumView:r,photoView:''});}.bind(this),this.$MessengerThreadSharedPhotos4=function(){this.setState({albumView:''});}.bind(this),this.$MessengerThreadSharedPhotos5=function(r){this.setState({albumView:'',photoView:r});}.bind(this),this.$MessengerThreadSharedPhotos6=function(){this.setState({photoView:''});}.bind(this),this.$MessengerThreadSharedPhotos7=function(r){this.setState({photoView:r});}.bind(this),n;}l.prototype.componentDidUpdate=function(){!this.state.photoView&&!this.state.albumView&&this.props.onCloseSharedPhotos();};l.prototype.render=function(){var m=this.state.photoView?this.$MessengerThreadSharedPhotos1():null,n=this.state.albumView?this.$MessengerThreadSharedPhotos2():null;return c('React').createElement('div',null,n,m);};l.prototype.$MessengerThreadSharedPhotos1=function(){return c('React').createElement(c('SpotlightMessengerSharedMediaViewerContainer.react'),{disableForward:false,onClosePhotoView:this.$MessengerThreadSharedPhotos6,openAlbum:this.$MessengerThreadSharedPhotos3,photoID:this.state.photoView,rootClassName:'',threadID:this.props.threadFBID});};l.prototype.$MessengerThreadSharedPhotos2=function(){return c('React').createElement(c('SpotlightViewer'),{className:"_3ode",onHide:this.$MessengerThreadSharedPhotos4,open:true,ref:'spotlightViewer'},c('React').createElement(c('MessengerSharedPhotosAlbumViewContainer.react'),{onClick:this.$MessengerThreadSharedPhotos5,onCloseSharedPhotos:this.props.onCloseSharedPhotos,threadID:this.props.threadFBID,viewedPhoto:this.state.albumView}));};l.propTypes={findFBID:k.string,onCloseSharedPhotos:k.func,threadFBID:k.string};f.exports=l;}),null);
__d('messengerThreadSharedPhotosReact',['reasonReact','MessengerThreadSharedPhotos.react'],(function a(b,c,d,e,f,g){'use strict';function h(i,j,k,l){return c('reasonReact').wrapJsForReason(c('MessengerThreadSharedPhotos.react'),{findFBID:i,onCloseSharedPhotos:j,threadFBID:k},l);}g.make=h;}),null);
__d('messengerVideoPlayerReact',['utilsRe','reasonReact','bs_js_null_undefined','MessengerVideoPlayer.react'],(function a(b,c,d,e,f,g){'use strict';function h(i,j,k,l,m,n,o,p,q,r){return c('reasonReact').wrapJsForReason(c('MessengerVideoPlayer.react'),{attachment:c('bs_js_null_undefined').from_opt(i),className:c('bs_js_null_undefined').from_opt(j),isInThread:c('utilsRe').optionBoolToNullUndefinedBoolean(k),isVisible:c('utilsRe').optionBoolToNullUndefinedBoolean(l),isOnStage:c('utilsRe').optionBoolToNullUndefinedBoolean(m),stageDimensions:c('bs_js_null_undefined').from_opt(n),videoData:o,onClick:c('bs_js_null_undefined').from_opt(p),onSelect:c('bs_js_null_undefined').from_opt(q)},r);}g.make=h;}),null);
__d('messengerVideoReact',['cx','ix','bs_curry','React','utilsRe','imageReact','bs_js_boolean','bs_pervasives','reasonReact','joinClasses','bs_js_primitive','messengerPhotoReact','messengerVideoPlayerReact'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('reasonReact').statelessComponent("MessengerVideo");function k(o){var p=true,q=true,r=false,s=o.metadata,t=0;if(c('bs_js_primitive').is_nil_undef(s)){t=1;}else if(c('utilsRe').isDefined(s.fbid)){var u=+(window.screen.width>1800)&&c('utilsRe').isDefined(s.large_size)&&c('utilsRe').isDefined(s.large_preview),v=s.fbid,w=u!==0?s.large_size:s.inbox_size,x=c('bs_js_primitive').is_nil_undef(w)?{x:0,y:0}:{x:w.width,y:w.height},y=u!==0?s.large_preview:s.inbox_preview;return {legacy_attachment_id:v,original_dimensions:x,start_muted:p,hide_controls_on_finish:q,url:y,is_share:r};}else t=1;if(t===1)return {legacy_attachment_id:null,original_dimensions:null,start_muted:p,hide_controls_on_finish:q,url:null,is_share:r};}function l(o){var p=o%60,q=+(p<10);return c('bs_pervasives').string_of_int(o/60|0)+(":"+((q!==0?"0":"")+c('bs_pervasives').string_of_int(p)));}function m(o,p,q,r,s,t,u,v){var w=o?o[0]:"",x=function ba(){var ca=p.metadata,da=p.media,ea=c('bs_js_primitive').is_nil_undef(ca)?c('bs_js_primitive').is_nil_undef(da)?0:c('bs_js_primitive').null_undefined_to_opt(da.duration):c('bs_js_primitive').null_undefined_to_opt(ca.duration);if(ea){return l(ea[0]);}else return null;},y=function ba(){if(t){return c('bs_curry')._1(t[0],p);}else return 0;},z=function ba(ca){var da=ca.legacy_attachment_id;if(c('utilsRe').isDefined(da)){return [c('reasonReact').element(0,0,c('messengerVideoPlayerReact').make([p],[c('joinClasses')(w,"_ccq","_4tsk","_3o67",c('bs_js_boolean').to_js_boolean(q)?"_52mr":'')],[1],s,0,0,ca,[y],u,[]))];}else return 0;},aa=j.slice();aa[9]=function(){var ba=k(p),ca=z(ba);if(ca){return ca[0];}else return c('reasonReact').element(0,0,c('messengerPhotoReact').make([c('joinClasses')(w,"_ccq")],p,q,r,t,[c('reasonReact').element(0,0,c('imageReact').make(["_ccr"],0,[i("27983")],0,0,0,0,[])),c('React').createElement("span",{className:"_ccs"},x(0))]));};return aa;}var n=1800;g.component=j;g.large_window_width=n;g.constructVideoData=k;g.formatDuration=l;g.make=m;}),null);
__d('MessengerXMATextBlock.react',['cx','LineClamp.react','React','ShimButton.react','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes,l=26;i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.$MessengerXMATextBlock1=function(){this.props.url&&window.open(this.props.url);}.bind(this),o;}m.prototype.render=function(){if(!this.props)return c('React').createElement('div',{className:"__6j"});var n=this.props.width?{maxWidth:this.props.width-l,textAlign:'left'}:{textAlign:'left'},o={textDecoration:'none'};return c('React').createElement('div',{className:c('joinClasses')(this.props.className,"__6j _43kk"),style:n},c('React').createElement(c('ShimButton.react'),{form:'link',onClick:this.$MessengerXMATextBlock1,style:o},this.renderTitle(),this.renderDescription(),this.renderSource()));};m.prototype.renderTitle=function(){if(!this.props.title)return null;return c('React').createElement('div',{className:"__6k"},c('React').createElement(c('LineClamp.react'),{lines:2,lineHeight:16},this.props.title));};m.prototype.renderDescription=function(){if(!this.props.description)return null;return c('React').createElement('div',{className:"__6l"},c('React').createElement(c('LineClamp.react'),{lines:2,lineHeight:15},this.props.description));};m.prototype.renderSource=function(){if(!this.props.source)return null;return c('React').createElement('div',{className:"__6m"},c('React').createElement(c('LineClamp.react'),{lines:1,lineHeight:14},this.props.source));};m.propTypes={className:k.string,description:k.string,source:k.string,title:k.string,url:k.string,width:k.number};f.exports=m;}),null);
__d('messengerXMATextBlockReact',['reasonReact','bs_js_null_undefined','MessengerXMATextBlock.react'],(function a(b,c,d,e,f,g){'use strict';function h(i,j,k,l,m,n,o){return c('reasonReact').wrapJsForReason(c('MessengerXMATextBlock.react'),{className:c('bs_js_null_undefined').from_opt(i),description:c('bs_js_null_undefined').from_opt(j),source:c('bs_js_null_undefined').from_opt(k),title:c('bs_js_null_undefined').from_opt(l),url:c('bs_js_null_undefined').from_opt(m),width:c('bs_js_null_undefined').from_opt(n)},o);}g.make=h;}),null);
__d("messengerVideoXMAReact",["cx","React","utilsRe","bs_pervasives","reasonReact","joinClasses","bs_js_primitive","messengerVideoPlayerReact","messengerXMATextBlockReact"],(function a(b,c,d,e,f,g,h){'use strict';var i=c("reasonReact").statelessComponent("MessengerVideoXMA");function j(p){if(c("bs_js_primitive").is_nil_undef(p)){return null;}else{var q=c("bs_pervasives").max(p.width,p.height),r=+(window.screen.width>1800),s=r!==0?640:450;if(q<=s){return {x:p.width,y:p.height};}else{var t=s/q,u=p.width*t|0,v=p.height*t|0;return {x:u,y:v};}}}function k(p){var q=p.media,r=p.target;if(c("bs_js_primitive").is_nil_undef(q)){return 0;}else if(c("bs_js_primitive").is_nil_undef(r)){return 0;}else if(c("utilsRe").isDefined(q.image_size)&&c("utilsRe").isDefined(r.video_id)){var s=q.image_size;return [{legacy_attachment_id:r.video_id,original_dimensions:j(s),start_muted:true,hide_controls_on_finish:true,url:q.image,is_share:true}];}else return 0;}function l(p,q,r,s,t){var u=p?p[0]:"",v=function y(z){if(z){return c("reasonReact").element(0,0,c("messengerVideoPlayerReact").make([q],[c("joinClasses")(u,"_ccq","_4tsk","_3o67","_52mr")],[1],r,0,0,z[0],0,s,[]));}else return null;},w=function y(z){return c("reasonReact").element(0,0,c("messengerXMATextBlockReact").make(["_2f5n _4br2 _29ew _3dug"],c("bs_js_primitive").null_undefined_to_opt(q.description),c("bs_js_primitive").null_undefined_to_opt(q.source),c("bs_js_primitive").null_undefined_to_opt(q.video_title),c("bs_js_primitive").null_undefined_to_opt(q.uri),z?[z[0].x]:0,[]));},x=i.slice();x[9]=function(){var y=k(q),z=v(y);return c("React").createElement("div",{className:"_3duc"},z,w(y?c("bs_js_primitive").null_undefined_to_opt(y[0].original_dimensions):0));};return x;}var m=640,n=450,o=1800;g.large_preview_dim=m;g.thumbinail_inbox_dim=n;g.large_window_width=o;g.component=i;g.adjustSize=j;g.constructVideoData=k;g.make=l;}),null);
__d('messengerPhotosGroupReact',['cx','URI','bs_list','bs_array','bs_block','bs_curry','React','fBIDRe','utilsRe','ActorURI','bs_caml_obj','bs_caml_array','bs_js_boolean','MercuryIDs','bs_pervasives','reasonReact','joinClasses','bs_js_primitive','bs_js_null_undefined','MessagesViewerSetID','messengerPhotoReact','messengerVideoReact','MercuryAttachmentType','getPageIDFromThreadID','messagingGiftWrapReact','messengerVideoXMAReact','bs_caml_builtin_exceptions','chatSpeakingStickerReact','MessengerAttachmentViewer','mercuryAttachmentPayloadRe','messagingFlowerBorderReact','messengerThreadSharedPhotosReact'],(function a(b,c,d,e,f,g,h){'use strict';var i="empty-spacer",j=c('reasonReact').statefulComponent("MessengerPhotosGroup");function k(m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){var ba=o?o[0]:"",ca=function ka(la){var ma=la.length,na=+(ma===2||ma===4);return c('joinClasses')(ba,"_2n8h",c('bs_js_boolean').to_js_boolean(+(ma===1))?"_2n8i":'',c('bs_js_boolean').to_js_boolean(na)?"_4ksk":'',c('bs_js_boolean').to_js_boolean(+(ma>1)&&1-na)?"_2n8k":'',"_5fk1");},da=function ka(la,ma){return c('bs_block').__(0,[[0]]);},ea=function ka(){if(v){var la=v[0],ma=la.thread_fbid;if(c('bs_js_primitive').is_nil_undef(ma)){return c('MercuryIDs').getThreadFBIDFromThreadID(la.thread_id);}else{var na=+(c('fBIDRe').compare(ma,"")===0);if(na!==0){return c('MercuryIDs').getThreadFBIDFromThreadID(la.thread_id);}else return ma;}}else return null;},fa=function ka(la,ma){var na=ea(0),oa=ma.metadata,pa=c('bs_js_primitive').is_nil_undef(oa)?null:oa.fbid;return c('reasonReact').element(0,0,c('messengerThreadSharedPhotosReact').make(pa,c('bs_curry')._1(la[0],da),na,[]));},ga=function ka(la,ma){return c('bs_block').__(0,[[[la]]]);},ha=function ka(la,ma,na,oa){var pa=c('utilsRe').isDefined(ma.deduplication_key),qa=ma.metadata,ra;if(pa!==0){ra=ma.deduplication_key;}else if(c('bs_js_primitive').is_nil_undef(qa)){ra=ma.upload_id;}else{var sa=qa.fbid;ra=c('bs_js_primitive').is_nil_undef(sa)?null:sa;}var ta=c('utilsRe').$pipe$unknown(c('bs_js_primitive').null_undefined_to_opt(ra),""),ua;if(!na&&s!==[1]){var va=ma.metadata;if(c('bs_js_primitive').is_nil_undef(va)){ua=0;}else if(c('utilsRe').isDefined(va.fbid)){var wa=1-c('utilsRe').isDefined(ma.app_attribution);ua=wa!==0?[c('bs_curry')._1(la[0],ga)]:[function(db){var eb=va,fb=db;if(c('utilsRe').isTruthy(fb.preview_uploading)){return 0;}else if(fb.attach_type===c('MercuryAttachmentType').VIDEO){var gb=eb.dimensions,hb=c('bs_js_primitive').is_nil_undef(gb)?{x:null,y:null}:{x:gb.width,y:gb.height};c('MessengerAttachmentViewer').renderVideo({pageID:c('bs_js_null_undefined').from_opt(z),rootClassName:"_1j1h",videoID:eb.fbid,videoSize:hb,videoURI:fb.url});return 0;}else if(fb.attach_type===c('MercuryAttachmentType').PHOTO||fb.attach_type===c('MercuryAttachmentType').THIRDPARTYSTICKER||fb.attach_type===c('MercuryAttachmentType').ANIMATED_IMAGE){var ib=+(m.length===1),jb=fb.url,kb;if(t!==[1]&&fb.attach_type===c('MercuryAttachmentType').PHOTO&&p!==0){var lb=ea(0),mb=+(p===[1]),nb=new (c('URI'))("/ajax/messaging/attachments/sharedphotos.php").setQueryData({thread_id:lb,image_id:eb.fbid}),ob=z?new (c('ActorURI').create)(nb,z[0]):nb;kb=[c('MessagesViewerSetID').MESSAGES_VIEW_ALL_IN_THREAD,ob,mb];}else kb=[null,jb,ib];c('MessengerAttachmentViewer').bootstrapWithConfig({actorid:c('bs_js_null_undefined').from_opt(z),dimensions:eb.dimensions,disableForward:c('bs_js_boolean').to_js_boolean(+(z!==0)),disablePaging:c('bs_js_boolean').to_js_boolean(kb[2]),endpoint:kb[1],fbid:eb.fbid,rootClassName:"_1j1h",setID:kb[0],snapToPhoto:true,src:fb.preview_url});return 0;}else if(c('utilsRe').isDefined(fb.uri)){return window.open(fb.uri);}else return 0;}];}else ua=0;}else ua=0;var xa=c('utilsRe').$pipe$unknown(n,ma.attach_type);if(xa===c('MercuryAttachmentType').PHOTO||xa===c('MercuryAttachmentType').ANIMATED_IMAGE||xa===c('MercuryAttachmentType').THIRDPARTYSTICKER){return c('reasonReact').element([ta],0,c('messengerPhotoReact').make(0,ma,oa,w,ua,[]));}else if(xa===c('MercuryAttachmentType').VIDEO){var ya=ma.metadata,za=0;if(c('bs_js_primitive').is_nil_undef(ya)){za=1;}else if(c('utilsRe').isTruthy(ya.render_as_sticker)){var ab=ya.dimensions,bb=c('bs_js_primitive').is_nil_undef(ab)?{height:null,width:null}:{height:ab.height,width:ab.width},cb=ma.url;return c('reasonReact').element(0,0,c('chatSpeakingStickerReact').make(cb,bb,[]));}else za=1;if(za===1)if(c('bs_caml_obj').caml_equal(t,[1])){return c('reasonReact').element([ta],0,c('messengerVideoXMAReact').make(0,ma,u,x,[]));}else return c('reasonReact').element([ta],0,c('messengerVideoReact').make(0,ma,oa,w,u,ua,x,[]));}else if(xa===i){return c('React').createElement("div",{key:c('bs_js_primitive').option_get(c('bs_js_primitive').null_undefined_to_opt(ma.key)),className:"_4tsk _4rf-"});}else throw [c('bs_caml_builtin_exceptions').invalid_argument,xa+" is not handled by MessengerPhotosGroup"];},ia=function ka(la,ma,na){if(ma.length===1){return ha(la,c('bs_caml_array').caml_array_get(ma,0),na,1);}else{var oa=+(ma.length===2||ma.length===4),pa=oa!==0?2:3,qa=0,ra=[0],sa=ma.length;while(ra[0]<sa){var ta=c('bs_pervasives').min(pa,sa-ra[0]|0),ua=c('bs_array').init(pa,function(va){return function(wa){var xa=+(wa<va);if(xa!==0){return ha(la,c('bs_caml_array').caml_array_get(ma,ra[0]+wa|0),na,0);}else{var ya="ghost"+c('bs_pervasives').string_of_int(pa-wa|0),za=c('mercuryAttachmentPayloadRe').create(i,[ya],new (c('URI'))(""));return ha(la,za,na,0);}};}(ta));qa=[c('React').createElement("div",{key:c('bs_pervasives').string_of_int(ra[0]),className:"_2n8g"},ua),qa];ra[0]=ra[0]+pa|0;}return c('bs_array').of_list(c('bs_list').rev(qa));}},ja=j.slice();ja[4]=function(){c('MessengerAttachmentViewer').preload();return 0;};ja[9]=function(ka){var la=v?c('utilsRe').isDefined(c('getPageIDFromThreadID')(v[0].thread_id)):0,ma=ia(ka,m,la),na=+(r===[1]),oa=na!==0?c('React').createElement("div",undefined,ma):ma,pa=ka[3][0],qa=pa?fa(ka,pa[0]):null,ra=+(r===[1]),sa=+(q===[1]);return c('React').createElement("div",{className:ca(m),tabIndex:0},qa,oa,ra!==0?c('reasonReact').element(0,0,c('messagingGiftWrapReact').make(0,y,[])):null,sa!==0?c('reasonReact').element(0,0,c('messagingFlowerBorderReact').make(-10,[])):null);};ja[10]=function(){return [0];};return ja;}var l=c('reasonReact').wrapReasonForJs(j,function(m){return k(m.attachments,c('bs_js_primitive').null_undefined_to_opt(m.attachType),c('bs_js_primitive').null_undefined_to_opt(m.className),m.count,c('utilsRe').nullUndefinedBooleanToOptionBool(m.hasFlowerBorder),c('utilsRe').nullUndefinedBooleanToOptionBool(m.isGiftWrapped),c('utilsRe').nullUndefinedBooleanToOptionBool(m.isPageMessage),c('utilsRe').nullUndefinedBooleanToOptionBool(m.isXMA),c('utilsRe').nullUndefinedBooleanToOptionBool(m.isVisible),c('bs_js_primitive').null_undefined_to_opt(m.message),c('bs_js_primitive').null_undefined_to_opt(m.onAttachmentLoad),c('bs_js_primitive').null_undefined_to_opt(m.onSelect),c('bs_js_primitive').null_undefined_to_opt(m.onUnwrap),c('bs_js_primitive').null_undefined_to_opt(m.pageID),[]);});g.empty_spacer_type=i;g.component=j;g.make=k;g.jsComponent=l;}),null);
__d('MessengerPhotosGroup.react',['messengerPhotosGroupReact'],(function a(b,c,d,e,f,g){'use strict';var h=c('messengerPhotosGroupReact').jsComponent;f.exports=h;}),null);