if (self.CavalryLogger) { CavalryLogger.start_js(["FBmmz"]); }

__d("NFXStoryLocation",[],(function a(b,c,d,e,f,g){f.exports={FEED:"feed",VIDEO_LIST_CHANNEL:"video_list_channel",VIDEO_PLAYLIST_CHANNEL:"video_playlist_channel",WATCHED_VIDEOS_CHANNEL:"watched_videos_channel",EXPLORE_FEED:"explore_feed",PROFILE_SELF:"profile_self",PROFILE_SOMEONE_ELSE:"profile_someone_else",PAGE:"page",PERMALINK:"permalink",PHOTO_VIEWER:"photo_viewer",PAGE_REVIEW:"page_review",POPULAR_AT:"popular_at",CURATED_SECTION:"curated_section",GROUP:"group",EVENT:"event",SEARCH:"search",UNKNOWN:"unknown",PROFILE_REPORTING_FLOW:"profile_reporting_flow",HEAD_PUBLISHER_APP_MENTIONS_FEED:"head_publisher_app_mentions_feed",MESSENGER:"messenger",MESSENGER_MONTAGE_VIEWER:"messenger_montage_viewer",FUNDRAISER_PAGE_FEED:"fundraiser_page_feed",FUNDRAISER_PERSON_TO_CHARITY:"fundraiser_person_to_charity",FUNDRAISER_PERSON_FOR_PERSON:"fundraiser_person_for_person",SETTINGS:"settings",LIVE_MAP:"live_map",JOB_BROWSER:"job_browser",CONTENT_OVERLAY:"content_overlay",CHEVRON:"chevron",VIDEO_INLINE_PIVOT:"video_inline_pivot",OBJECTIONABLE_CONTENT_FILTER:"objectionable_content_filter",MESSENGER_THREAD_ACTION_PANEL:"messenger_thread_action_panel",MESSENGER_CONTACT_DETAILS:"messenger_contact_details",TICKER:"ticker",FULLSCREEN_VIDEO_PLAYER:"fullscreen_video_player",ACTIVITY_LOG_FACE_ALERTS:"face_alerts",HELP_COMMUNITY:"help_community",SUPPORT_INBOX:"support_inbox",APP_INVITES_FEED:"app_invites_feed",CHAINING_FEED:"chaining_feed",SOCIAL_REPORTING_REDIRECT:"social_reporting_redirect",WWW_CHAT_HEAD:"www_chat_head",THROWBACK:"throwback",POST_TO_PAGE:"post_to_page",ACTIVITY_LOG:"activity_log",VIDEO_CHANNEL:"video_channel",VIDEO_CHANNELS:"video_channels",VIDEO_HOME:"video_home",REVIEWS_FEED:"reviews_feed",BACKSTAGE:"backstage",MESSENGER_ENCRYPTED_THREAD:"messenger_encrypted_thread",LOCAL_NEWS:"local_news",MARKETPLACE_PDP:"marketplace_pdp",MARKETPLACE_PROFILE:"marketplace_profile",MARKETPLACE_RATING_CONFIRMATION:"marketplace_rating_confirmation",MARKETPLACE_RATING_FLOW:"marketplace_rating_flow",MARKETPLACE_THREAD:"marketplace_thread",MARKETPLACE_THREAD_BUYER:"marketplace_thread_buyer",POLITICAL_ISSUE_MODULE:"political_issue_module",ELECTION_HUB:"election_hub",DIRECT_MESSAGING:"direct_messaging",CAMERA_MEDIA_EFFECT:"camera_media_effect",PROFILE_DEPRECATED:"profile",TIMELINE_DEPRECATED:"timeline",BREAKUP_FLOW:"breakup_flow",ASYNC_TASK_DO_NOT_USE:"async",INSTANT_ARTICLES:"instant_articles",INSTANT_ARTICLE_WEBVIEW_AD:"instant_article_webview_ad",IN_APP_BROWSER:"in_app_browser",INSTREAM_VIDEO:"instream_video",TOPIC_PAGE:"topic_page",GAMES_FEED:"games_feed",TAG_QUARANTINE:"tag_qurantine",STONEHENGE_CONSUMPTION:"stonehenge_consumption"};}),null);
__d('Video.react',['React','ReactDOM'],(function a(b,c,d,e,f,g){var h,i,j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').Component);i=h&&h.prototype;k.prototype.componentDidMount=function(){'use strict';var l=c('ReactDOM').findDOMNode(this.refs.video);if(this.props.paused&&l&&l.pause)l.pause();};k.prototype.componentWillUpdate=function(l,m){'use strict';var n=c('ReactDOM').findDOMNode(this.refs.video);if(l.playbackRate)n.playbackRate=l.playbackRate;if(l.paused!=this.props.paused&&n)if(l.paused&&n.pause){n.pause();}else if(n.play)n.play();};k.prototype.render=function(){'use strict';return c('React').createElement('video',babelHelpers['extends']({},this.props,{ref:'video'}));};function k(){'use strict';h.apply(this,arguments);}k.propTypes={autoPlay:j.bool,paused:j.bool,controls:j.bool,height:j.oneOfType([j.string,j.number]),loop:j.bool,muted:j.bool,onAbort:j.func,onCanPlay:j.func,onCanPlayThrough:j.func,onDurationChange:j.func,onEmptied:j.func,onEncrypted:j.func,onEnded:j.func,onError:j.func,onLoadedData:j.func,onLoadedMetadata:j.func,onLoadStart:j.func,onPause:j.func,onPlay:j.func,onPlaying:j.func,onProgress:j.func,onRateChange:j.func,onSeeked:j.func,onSeeking:j.func,onStalled:j.func,onSuspend:j.func,onTimeUpdate:j.func,onVolumeChange:j.func,onWaiting:j.func,playbackRate:j.number,poster:j.string,src:j.string.isRequired,width:j.oneOfType([j.string,j.number])};f.exports=k;}),null);
__d('MenuSeparator',['cx','DOM','CSS','MenuItemInterface'],(function a(b,c,d,e,f,g,h){var i,j;i=babelHelpers.inherits(k,c('MenuItemInterface'));j=i&&i.prototype;function k(l){'use strict';j.constructor.call(this,l);this._data=l;this.showFn=this._data.should_show_fn;}k.prototype.updateShownState=function(l){'use strict';if(this.showFn){this._isHidden=!this.showFn(l);if(this._root)c('CSS').conditionShow(this._root,!this._isHidden);}};k.prototype.isShown=function(l){'use strict';var m=this.showFn?this.showFn(l):true;return m;};k.prototype.render=function(){'use strict';var l="_54ak";if(this._data.className)l+=' '+this._data.className;var m=this._data.label||'',n=c('DOM').create('li',{className:l,role:'separator'},m);if(this._isHidden)c('CSS').hide(n);return n;};f.exports=k;}),null);
__d('MenuSeparator.react',['MenuSeparator'],(function a(b,c,d,e,f,g){function h(j){j.isReactLegacyFactory={};j.type=j;}var i=c('MenuSeparator');h(i);f.exports=i;}),null);
__d('XUICard.react',['cx','React','XUIBlock','joinClasses'],(function a(b,c,d,e,f,g,h){var i,j;i=babelHelpers.inherits(k,c('React').Component);j=i&&i.prototype;k.prototype.render=function(){'use strict';var l=c('joinClasses')("_4-u2",c('XUIBlock').getBackgroundClass(this.props));return c('React').createElement('div',babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,l)}),this.props.children);};function k(){'use strict';i.apply(this,arguments);}k.propTypes=c('XUIBlock').propTypes;k.defaultProps=babelHelpers['extends']({},c('XUIBlock').getDefaultProps(),{background:'white'});f.exports=k;}),null);
__d('MessengerMontageClientTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],(function a(b,c,d,e,f,g){'use strict';function h(){this.clear();}h.prototype.log=function(){c('GeneratedLoggerUtils').log('logger:MessengerMontageClientLoggerConfig',this.$MessengerMontageClientTypedLogger1,c('Banzai').BASIC);};h.prototype.logVital=function(){c('GeneratedLoggerUtils').log('logger:MessengerMontageClientLoggerConfig',this.$MessengerMontageClientTypedLogger1,c('Banzai').VITAL);};h.prototype.clear=function(){this.$MessengerMontageClientTypedLogger1={};return this;};h.prototype.updateData=function(j){this.$MessengerMontageClientTypedLogger1=babelHelpers['extends']({},this.$MessengerMontageClientTypedLogger1,j);return this;};h.prototype.setContentType=function(j){this.$MessengerMontageClientTypedLogger1.content_type=j;return this;};h.prototype.setCurrentPosition=function(j){this.$MessengerMontageClientTypedLogger1.current_position=j;return this;};h.prototype.setEntryPoint=function(j){this.$MessengerMontageClientTypedLogger1.entry_point=j;return this;};h.prototype.setEvent=function(j){this.$MessengerMontageClientTypedLogger1.event=j;return this;};h.prototype.setExitAction=function(j){this.$MessengerMontageClientTypedLogger1.exit_action=j;return this;};h.prototype.setMessageDuration=function(j){this.$MessengerMontageClientTypedLogger1.message_duration=j;return this;};h.prototype.setMessageSource=function(j){this.$MessengerMontageClientTypedLogger1.message_source=j;return this;};h.prototype.setMessageStartTime=function(j){this.$MessengerMontageClientTypedLogger1.message_start_time=j;return this;};h.prototype.setMid=function(j){this.$MessengerMontageClientTypedLogger1.mid=j;return this;};h.prototype.setOwnerID=function(j){this.$MessengerMontageClientTypedLogger1.owner_id=j;return this;};h.prototype.setQueueType=function(j){this.$MessengerMontageClientTypedLogger1.queue_type=j;return this;};h.prototype.setTotalQueue=function(j){this.$MessengerMontageClientTypedLogger1.total_queue=j;return this;};h.prototype.setVC=function(j){this.$MessengerMontageClientTypedLogger1.vc=j;return this;};h.prototype.updateExtraData=function(j){j=c('nullthrows')(c('GeneratedLoggerUtils').serializeMap(j));c('GeneratedLoggerUtils').checkExtraDataFieldNames(j,i);this.$MessengerMontageClientTypedLogger1=babelHelpers['extends']({},this.$MessengerMontageClientTypedLogger1,j);return this;};h.prototype.addToExtraData=function(j,k){var l={};l[j]=k;return this.updateExtraData(l);};var i={content_type:true,current_position:true,entry_point:true,event:true,exit_action:true,message_duration:true,message_source:true,message_start_time:true,mid:true,owner_id:true,queue_type:true,total_queue:true,vc:true};f.exports=h;}),null);
__d('MessengerLogo.react',['React'],(function a(b,c,d,e,f,g){'use strict';var h=function i(j){var k=j.color,l=j.size;return c('React').createElement('div',{style:{width:l,height:l}},c('React').createElement('svg',{viewBox:'0 0 16 16',version:'1.1',xmlns:'http://www.w3.org/2000/svg'},c('React').createElement('g',{transform:'scale(0.02)',fill:'none'},c('React').createElement('path',{fill:k,fillRule:'evenodd',d:'M399.494079,0.00274415094 C178.859771,0.00274415094 0.000304955527,167.227237 0.000304955527,373.508113 C0.000304955527,490.856138 57.8859466,595.562774 148.414028,664.036455 L148.414028,806.983343 L284.747446,731.373854 C321.092046,741.545506 359.609962,747.013481 399.494079,747.013481 C620.128386,747.013481 798.987853,579.788988 798.987853,373.508113 C798.987853,167.227237 620.128386,0.00274415094 399.494079,0.00274415094 M441.568386,500.879189L338.245388 393.558495 139.264956 503.581669 357.419975 272.117619 460.742973 379.437297 659.722389 269.414122z'}))));};f.exports=h;}),null);
__d('MontageDispatcher',['ExplicitRegistrationDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('ExplicitRegistrationDispatcher'));i=h&&h.prototype;function j(){h.apply(this,arguments);}f.exports=new j({strict:false});}),null);
__d('MontageActions',['MontageDispatcher','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({REQUEST_UPDATE:null,HAS_UPDATED:null}),i={Types:h,requestUpdate:function j(k){c('MontageDispatcher').dispatch({type:h.REQUEST_UPDATE,threadFBID:k});},hasUpdated:function j(k){c('MontageDispatcher').dispatch({type:h.HAS_UPDATED,threadFBID:k});}};f.exports=i;}),null);
__d('MessengerMenu.react',['cx','Keys','MenuSeparator.react','ReactXUIMenu','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;function k(m){m.isReactLegacyFactory={};m.type=m;}i=babelHelpers.inherits(l,c('ReactXUIMenu'));j=i&&i.prototype;function l(m){var n=m.className,o=babelHelpers.objectWithoutProperties(m,['className']);j.constructor.call(this,babelHelpers['extends']({className:c('joinClasses')(n,"_2i-c _150g")},o));}l.prototype.handleKeydown=function(m,n){if(m===c('Keys').DOWN||m===c('Keys').UP||m===c('Keys').SPACE)return j.handleKeydown.call(this,m,n);return true;};k(l);l.Item=c('ReactXUIMenu').Item;l.Separator=c('MenuSeparator.react');f.exports=l;}),null);
__d('MessengerPopoverMenu.react',['cx','ContextualDialogArrow','ContextualLayerAutoFlip','ContextualLayerUpdateOnScroll','PopoverMenu.react','React','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;i=babelHelpers.inherits(k,c('React').PureComponent);j=i&&i.prototype;k.prototype.showPopover=function(){this.refs.menu&&this.refs.menu.showPopover();};k.prototype.render=function(){var l=this.props,m=l.children,n=l.className,o=l.isOpen,p=babelHelpers.objectWithoutProperties(l,['children','className','isOpen']),q=c('React').Children.only(m);return c('React').createElement(c('PopoverMenu.react'),babelHelpers['extends']({className:c('joinClasses')(n,!p.disableArrowKeyActivation||o?"_150g":''),enableActivationOnEnter:true,layerBehaviors:[c('ContextualLayerAutoFlip'),c('ContextualLayerUpdateOnScroll'),c('ContextualDialogArrow')]},p,{ref:'menu'}),q);};function k(){i.apply(this,arguments);}f.exports=k;}),null);
__d('MontageProgressBar.react',['cx','React'],(function a(b,c,d,e,f,g,h){'use strict';var i=function j(k){var l=k.activeIndex,m=k.count,n=k.progressPercent,o=[];for(var p=0;p<m;p++)o.push(c('React').createElement('div',{key:p,className:"_4wd4"+(p===l?' '+"_4wd6":'')},p===l?c('React').createElement('div',{className:"_4wd4 _4wd7",style:{width:n+'%'}}):null));return c('React').createElement('div',{className:"_4wd8"},o);};f.exports=i;}),null);
__d("XRapidReportingMessageDialogController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/rapid_report\/message\/",{message_id:{type:"String",required:true},story_location:{type:"String",required:true}});}),null);
__d('MontageCard.react',['cx','fbt','AsyncRequest','CssBackgroundImage.react','MessengerMenu.react','MontageProgressBar.react','MessengerPopoverMenu.react','Link.react','NFXStoryLocation','React','Relay','RelayQL','Timestamp.react','XRapidReportingMessageDialogController','idx'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('MessengerMenu.react').Item,m=c('React').PropTypes,n=['montage_camera','montage_composition'],o=function q(r){return r.stopPropagation();};j=babelHelpers.inherits(p,c('React').Component);k=j&&j.prototype;function p(){var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=k.constructor).call.apply(q,[this].concat(t)),this.state={progressPercent:0},this.$MontageCard3=function(){var v,w=(v=this.props)!=null?(v=v.message)!=null?v.message_id:v:v;if(w){var x=c('XRapidReportingMessageDialogController').getURIBuilder().setString('message_id',w).setString('story_location',c('NFXStoryLocation').MESSENGER_MONTAGE_VIEWER).getURI(),y=new (c('AsyncRequest'))().setURI(x);y.send();}}.bind(this),this.$MontageCard1=function(v){if(v!==this.state.progressPercent)this.setState({progressPercent:v});}.bind(this),r;}p.prototype.render=function(){var q=this.props,r=q.active,s=q.activeIndex,t=q.count,u=q.message;if(!u)return null;var v=u.message_sender.messaging_actor,w=u.timestamp,x=u.message_source_data&&u.message_source_data.message_source,y=n.indexOf(x)===-1,z=c('React').Children.map(this.props.children,function(aa){return c('React').cloneElement(aa,{renderWithBorder:y,onProgress:this.$MontageCard1});}.bind(this));if(y)z=c('React').createElement('div',{className:"_3avs"},z);return c('React').createElement('div',{className:"_5uag _q38",style:{zIndex:r?1:undefined}},z,c('React').createElement('div',{className:"_5uag _1pwf"},c('React').createElement(c('MontageProgressBar.react'),{activeIndex:s,count:t,progressPercent:this.state.progressPercent}),c('React').createElement('div',{className:"_1pwg"},c('React').createElement(c('CssBackgroundImage.react'),{className:"_3cx4",imageURI:v.profile_picture.uri}),c('React').createElement('div',{className:"_1pwn"},c('React').createElement('span',null,v.name),c('React').createElement(c('Timestamp.react'),{className:"_yc_",minimize:true,time:w})),c('React').createElement(c('MessengerPopoverMenu.react'),{className:"_47gp",menu:this.$MontageCard2()},c('React').createElement(c('Link.react'),{'aria-haspopup':'true','aria-label':i._("Message Options"),className:"_47gq",onMouseUp:o,onMouseDown:o,role:'button'})))));};p.prototype.$MontageCard2=function(){var q=c('React').createElement(c('MessengerMenu.react'),null,c('React').createElement(l,{label:i._("Report"),onclick:this.$MontageCard3}));return q;};p.propTypes={active:m.bool.isRequired,activeIndex:m.number.isRequired,count:m.number.isRequired,message:m.object,children:m.object};f.exports=c('Relay').createContainer(p,{fragments:{message:function q(){return function(){return {children:[{fieldName:'message_id',kind:'Field',metadata:{},type:'ID'},{children:[{fieldName:'message_source',kind:'Field',metadata:{},type:'String'}],fieldName:'message_source_data',kind:'Field',metadata:{canHaveSubselections:true},type:'MessageSourceData'},{children:[{children:[{fieldName:'name',kind:'Field',metadata:{},type:'String'},{calls:[{kind:'Call',metadata:{type:'Int'},name:'height',value:{kind:'CallValue',callValue:50}},{kind:'Call',metadata:{type:'Int'},name:'width',value:{kind:'CallValue',callValue:50}}],children:[{fieldName:'uri',kind:'Field',metadata:{},type:'Url'}],fieldName:'profile_picture',kind:'Field',metadata:{canHaveSubselections:true},type:'Image'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'}],fieldName:'messaging_actor',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id',isAbstract:true},type:'MessagingActor'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],fieldName:'message_sender',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id'},type:'MessagingParticipant'},{fieldName:'timestamp',kind:'Field',metadata:{},type:'Time'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{},name:'MontageCard_react_MessageRelayQL',type:'UserMessage'};}();}}});}),null);
__d('montageCardWithStandardTimer',['React','cancelAnimationFrame','requestAnimationFrame'],(function a(b,c,d,e,f,g){'use strict';var h=c('React').PropTypes,i=8000;function j(k){var l,m;return m=l=function(){var n,o;n=babelHelpers.inherits(p,c('React').Component);o=n&&n.prototype;function p(){var q,r;'use strict';for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=o.constructor).call.apply(q,[this].concat(t)),this.state={startedTime:0,pausedTime:0},this.$_class1=null,this.$_class3=function(){if(!this.props.paused){var v=(Date.now()-this.state.startedTime)/i*100;this.props.onProgress(v);if(v>=100){this.props.onEnded();return;}}this.$_class1=c('requestAnimationFrame')(this.$_class3);}.bind(this),r;}p.prototype.componentDidMount=function(){'use strict';this.$_class2();};p.prototype.componentDidUpdate=function(){'use strict';this.$_class2();};p.prototype.$_class2=function(){'use strict';if(!this.props.active&&(this.$_class1||this.state.pausedTime)){this.$_class4();}else if(!this.props.paused&&!this.$_class1){this.$_class5();}else if(this.$_class1&&this.props.paused)this.$_class6();};p.prototype.$_class6=function(){'use strict';this.setState({pausedTime:Date.now()});c('cancelAnimationFrame')(this.$_class1);this.$_class1=null;};p.prototype.$_class5=function(){'use strict';var q={startedTime:Date.now()};if(this.state.pausedTime){var r=q.startedTime-this.state.pausedTime,s=this.state.startedTime+r;q={pausedTime:0,startedTime:s};}this.setState(q);this.$_class1=c('requestAnimationFrame')(this.$_class3);};p.prototype.$_class4=function(){'use strict';this.setState({pausedTime:0,startedTime:0});c('cancelAnimationFrame')(this.$_class1);this.$_class1=null;};p.prototype.componentWillUnmount=function(){'use strict';c('cancelAnimationFrame')(this.$_class1);};p.prototype.render=function(){'use strict';var q=this.props,r=q.paused,s=q.onEnded,t=q.onProgress,u=babelHelpers.objectWithoutProperties(q,['paused','onEnded','onProgress']);return c('React').createElement(k,u);};return p;}(),l.propTypes={active:h.bool.isRequired,paused:h.bool.isRequired,onEnded:h.func.isRequired,onProgress:h.func.isRequired},m;}f.exports=j;}),null);
__d('MontageCardPhoto.react',['cx','CssBackgroundImage.react','Image.react','React','Relay','RelayQL','montageCardWithStandardTimer'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;l.prototype.render=function(){return this.props.renderWithBorder?c('React').createElement('div',{className:"_5uag _3p9v"},c('React').createElement(c('Image.react'),{className:"_3p9w",src:this.props.photoAttachment.image.uri})):c('React').createElement(c('CssBackgroundImage.react'),{className:"_5uag",imageURI:this.props.photoAttachment.image.uri});};function l(){i.apply(this,arguments);}l.propTypes={photoAttachment:k.shape({image:k.shape({uri:k.string.isRequired}).isRequired}).isRequired};f.exports=c('Relay').createContainer(c('montageCardWithStandardTimer')(l),{fragments:{photoAttachment:function m(){return function(){return {children:[{children:[{fieldName:'uri',kind:'Field',metadata:{},type:'Url'}],fieldName:'image',kind:'Field',metadata:{canHaveSubselections:true},type:'Image'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{},name:'MontageCardPhoto_react_PhotoAttachmentRelayQL',type:'MessageImage'};}();}}});}),null);
__d('MontageCardSticker.react',['cx','Image.react','React','Relay','RelayQL','montageCardWithStandardTimer'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;l.prototype.render=function(){var m=this.props.sticker.animated_image?this.props.sticker.animated_image.uri:this.props.sticker.image.uri;return c('React').createElement('div',{className:"_5uag _3p9v"},c('React').createElement(c('Image.react'),{src:m}));};function l(){i.apply(this,arguments);}l.propTypes={sticker:k.shape({animated_image:k.shape({uri:k.string.isRequired}),image:k.shape({uri:k.string.isRequired})}).isRequired};f.exports=c('Relay').createContainer(c('montageCardWithStandardTimer')(l),{fragments:{sticker:function m(){return function(){return {children:[{children:[{fieldName:'uri',kind:'Field',metadata:{},type:'Url'}],fieldName:'image',kind:'Field',metadata:{canHaveSubselections:true},type:'Image'},{children:[{fieldName:'uri',kind:'Field',metadata:{},type:'Url'}],fieldName:'animated_image',kind:'Field',metadata:{canHaveSubselections:true},type:'Image'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{},name:'MontageCardSticker_react_StickerRelayQL',type:'Sticker'};}();}}});}),null);
__d('MontageCardText.react',['cx','MessengerTextWithEntities.react','React','Relay','RelayQL','montageCardWithStandardTimer'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;l.prototype.render=function(){return c('React').createElement(c('MessengerTextWithEntities.react'),{className:"_5uag _2zz1",customSize:true,renderEmoji:true,text:this.props.userMessage.message.text});};function l(){i.apply(this,arguments);}l.propTypes={userMessage:k.shape({message:k.shape({text:k.string.isRequired}).isRequired}).isRequired};f.exports=c('Relay').createContainer(c('montageCardWithStandardTimer')(l),{fragments:{userMessage:function m(){return function(){return {children:[{children:[{fieldName:'text',kind:'Field',metadata:{},type:'String'}],fieldName:'message',kind:'Field',metadata:{canHaveSubselections:true},type:'TextWithEntities'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{},name:'MontageCardText_react_UserMessageRelayQL',type:'UserMessage'};}();}}});}),null);
__d('MontageCardVideo.react',['cx','Video.react','React','Relay','RelayQL','cancelAnimationFrame','requestAnimationFrame'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.$MontageCardVideo1=null,this.$MontageCardVideo5=function(){if(this.$MontageCardVideo2&&this.$MontageCardVideo2.readyState>0){var r=this.$MontageCardVideo2.currentTime/this.$MontageCardVideo2.duration*100;this.props.onProgress(r);if(r>=100){this.props.onEnded();return;}}this.$MontageCardVideo1=c('requestAnimationFrame')(this.$MontageCardVideo5);}.bind(this),n;}l.prototype.componentDidMount=function(){this.$MontageCardVideo3();};l.prototype.componentDidUpdate=function(){this.$MontageCardVideo3();};l.prototype.componentWillUnmount=function(){this.$MontageCardVideo4();};l.prototype.$MontageCardVideo3=function(){if(!this.$MontageCardVideo2)return;if(!this.props.paused&&this.$MontageCardVideo2.paused){this.$MontageCardVideo2.play();this.$MontageCardVideo1=c('requestAnimationFrame')(this.$MontageCardVideo5);}else{this.$MontageCardVideo4();if(!this.props.active&&this.$MontageCardVideo2)this.$MontageCardVideo2.currentTime=0;}};l.prototype.$MontageCardVideo4=function(){c('cancelAnimationFrame')(this.$MontageCardVideo1);this.$MontageCardVideo1=null;if(this.$MontageCardVideo2)this.$MontageCardVideo2.pause();};l.prototype.render=function(){return c('React').createElement(c('Video.react'),{autoPlay:false,className:"_5uag",onEnded:this.props.onEnded,onError:this.props.onEnded,src:this.props.videoAttachment.playable_url,ref:function(m){return this.$MontageCardVideo2=m&&m.refs.video;}.bind(this)});};l.propTypes={paused:k.bool.isRequired,onEnded:k.func.isRequired,onProgress:k.func.isRequired,videoAttachment:k.shape({playable_url:k.string.isRequired}).isRequired};f.exports=c('Relay').createContainer(l,{fragments:{videoAttachment:function m(){return function(){return {children:[{fieldName:'playable_url',kind:'Field',metadata:{},type:'Url'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{},name:'MontageCardVideo_react_VideoAttachmentRelayQL',type:'MessageVideo'};}();}}});}),null);
__d('MontageShouldUpdateReducer',['MontageActions'],(function a(b,c,d,e,f,g){'use strict';var h=c('MontageActions').Types;function i(k,l){var m;switch(l.type){case h.REQUEST_UPDATE:var n=babelHelpers['extends']({},k.needsUpdating,(m={},m[l.threadFBID]=true,m));return babelHelpers['extends']({},k,{needsUpdating:n});}return k;}function j(k,l){switch(l.type){case h.HAS_UPDATED:var m=k.needsUpdating,n=m[l.threadFBID],o=babelHelpers.objectWithoutProperties(m,[l.threadFBID]);return babelHelpers['extends']({},k,{needsUpdating:o});}return k;}f.exports={requestUpdate:i,hasUpdated:j};}),null);
__d('MontageSpotlightViewer.react',['KeyEventController','MessengerMobileWindow.react','MessengerMontageClientTypedLogger','MontageCard.react','MontageCardPhoto.react','MontageCardSticker.react','MontageCardText.react','MontageCardVideo.react','React','Relay','RelayQL','SubscriptionsHandler'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('React').PropTypes,k=300,l={auto_play:'auto_play',click:'click',arrow:'arrow',esc:'esc',click_exit_button:'click_exit_button'},m={next:'_next',prev:'_prev'},n=function q(event,r){if(r=='onkeyup')return c('KeyEventController').filterEventTargets(event,r)&&c('KeyEventController').filterEventModifiers(event,r);return false;};h=babelHelpers.inherits(o,c('React').Component);i=h&&h.prototype;function o(){var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=i.constructor).call.apply(q,[this].concat(t)),this.state=this.initialState(),this.$MontageSpotlightViewer1=new (c('SubscriptionsHandler'))(),this.$MontageSpotlightViewer2='unknown',this.$MontageSpotlightViewer3=null,this.$MontageSpotlightViewer6=function(){this.setState({paused:Date.now()});}.bind(this),this.$MontageSpotlightViewer7=function(){var v=Date.now()-this.state.paused;if(v<k){this.$MontageSpotlightViewer5(l.click);}else this.setState({paused:0});}.bind(this),this.$MontageSpotlightViewer9=function(){this.setState({cardIndex:0,paused:0,open:false});}.bind(this),this.$MontageSpotlightViewer12=this.$MontageSpotlightViewer5.bind(this,l.auto_play),this.$MontageSpotlightViewer8=function(){this.$MontageSpotlightViewer3=Date.now();}.bind(this),r;}o.prototype.initialState=function(){var q=this.props.messages?this.props.messages.count:1;return {cardIndex:this.props.initialUnreadCount?q-this.props.initialUnreadCount:0,open:true,paused:0};};o.prototype.componentDidMount=function(){this.$MontageSpotlightViewer1.addSubscriptions(c('KeyEventController').registerKey('LEFT',function(){this.$MontageSpotlightViewer4(l.arrow);return false;}.bind(this)),c('KeyEventController').registerKey('RIGHT',function(){this.$MontageSpotlightViewer5(l.arrow);return false;}.bind(this)),c('KeyEventController').registerKey('SPACE',function(){if(!this.state.paused)this.$MontageSpotlightViewer6();return false;}.bind(this)),c('KeyEventController').registerKey('SPACE',function(){this.$MontageSpotlightViewer7();return false;}.bind(this),n));this.$MontageSpotlightViewer8();};o.prototype.render=function(){return c('React').createElement(c('MessengerMobileWindow.react'),{onClose:this.$MontageSpotlightViewer9,onHide:this.props.onHide,onMouseDown:this.$MontageSpotlightViewer6,onMouseUp:this.$MontageSpotlightViewer7,open:this.state.open},this.$MontageSpotlightViewer10());};o.prototype.componentWillUnmount=function(){this.$MontageSpotlightViewer1&&this.$MontageSpotlightViewer1.release();this.$MontageSpotlightViewer1=null;};o.prototype.$MontageSpotlightViewer10=function(){var q=this.props.messages||{edges:[{node:this.props.message}]};return q.edges.map(function(r,s){var t=r.node;if(!t||s<this.state.cardIndex-3||s>this.state.cardIndex+3)return null;var u=t.blob_attachments[0],v=t.sticker,w=this.props.messages?this.props.messages.count:1,x=s===this.state.cardIndex,y=!(x&&!this.state.paused),z=null,aa=u&&u.__typename;if(aa==='MessageImage'){x&&this.$MontageSpotlightViewer11('photo');z=c('React').createElement(c('MontageCardPhoto.react'),{active:x,onEnded:this.$MontageSpotlightViewer12,paused:y,photoAttachment:u});}else if(aa==='MessageVideo'){x&&this.$MontageSpotlightViewer11('video');z=c('React').createElement(c('MontageCardVideo.react'),{active:x,onEnded:this.$MontageSpotlightViewer12,paused:y,videoAttachment:u});}else if(v){x&&this.$MontageSpotlightViewer11('sticker');z=c('React').createElement(c('MontageCardSticker.react'),{active:x,onEnded:this.$MontageSpotlightViewer12,paused:y,sticker:v});}else{x&&this.$MontageSpotlightViewer11('text');z=c('React').createElement(c('MontageCardText.react'),{active:x,onEnded:this.$MontageSpotlightViewer12,paused:y,userMessage:t});}return z?c('React').createElement(c('MontageCard.react'),{active:x,activeIndex:this.state.cardIndex,count:w,key:t.message_id,message:t},z):null;}.bind(this)).filter(Boolean);};o.prototype.$MontageSpotlightViewer11=function(q){this.$MontageSpotlightViewer2=q;};o.prototype.$MontageSpotlightViewer4=function(q){this.logMessageExit(q+m.prev);var r=this.state.cardIndex-1;if(r<0){this.$MontageSpotlightViewer9();return;}this.setState({cardIndex:r,paused:0},this.$MontageSpotlightViewer8);};o.prototype.$MontageSpotlightViewer5=function(q){this.logMessageExit(q+m.next);var r=this.props.messages?this.props.messages.count:1,s=this.state.cardIndex+1;if(s>=r){this.$MontageSpotlightViewer9();return;}this.props.loadMore(1);this.setState({cardIndex:s,paused:0},this.$MontageSpotlightViewer8);};o.prototype.logMessageExit=function(q){var r=Date.now(),s=this.props.messages?this.props.messages.count:1,t=this.props.initialUnreadCount||s,u=this.state.cardIndex-(s-t)+1,v=this.props.initialUnreadCount?'unseen':'seen',w=void 0;if(this.props.messages){var x=this.props.messages.edges[this.state.cardIndex];w=x&&x.node;}else w=this.props.message;if(!w||!this.$MontageSpotlightViewer3)return;var y=r-this.$MontageSpotlightViewer3;new (c('MessengerMontageClientTypedLogger'))().setEvent('message_exit').setMid(w.message_id).setOwnerID(w.message_sender.id).setMessageSource(w.message_source_data&&w.message_source_data.message_source).setExitAction(q).setContentType(this.$MontageSpotlightViewer2).setTotalQueue(t).setQueueType(v).setCurrentPosition(u).setEntryPoint(this.props.entryPoint).setMessageStartTime(this.$MontageSpotlightViewer3).setMessageDuration(y).log();};o.propTypes={entryPoint:j.oneOf(['thread_head','reply_context']),initialUnreadCount:j.number,onHide:j.func.isRequired,loadMore:j.func.isRequired,message:j.object,messages:j.object,relay:j.object.isRequired};var p=function(q,r,s,t,u){return {children:[].concat.apply([],[{fieldName:'message_id',kind:'Field',metadata:{},type:'ID'},{children:[{fieldName:'id',kind:'Field',metadata:{isRequisite:true},type:'ID'}],fieldName:'message_sender',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id'},type:'MessagingParticipant'},{children:[{fieldName:'message_source',kind:'Field',metadata:{},type:'String'}],fieldName:'message_source_data',kind:'Field',metadata:{canHaveSubselections:true},type:'MessageSourceData'},{children:[].concat.apply([],[{fieldName:'__typename',kind:'Field',metadata:{isRequisite:true},type:'String'},c('RelayQL').__frag(s),c('RelayQL').__frag(t),{children:[{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{isAbstract:true},name:'IdFragment',type:'Node'}]),fieldName:'blob_attachments',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id',isAbstract:true,isPlural:true},type:'MessageBlobAttachment'},{children:[].concat.apply([],[{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},c('RelayQL').__frag(u)]),fieldName:'sticker',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id'},type:'Sticker'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},c('RelayQL').__frag(q),c('RelayQL').__frag(r)]),id:c('RelayQL').__id(),kind:'Fragment',metadata:{},name:'MontageSpotlightViewer_reactRelayQL',type:'UserMessage'};}(c('MontageCard.react').getFragment('message'),c('MontageCardText.react').getFragment('userMessage'),c('MontageCardPhoto.react').getFragment('photoAttachment'),c('MontageCardVideo.react').getFragment('videoAttachment'),c('MontageCardSticker.react').getFragment('sticker'));f.exports=c('Relay').createContainer(o,{fragments:{messages:function q(){return function(r){return {children:[{fieldName:'count',kind:'Field',metadata:{},type:'Int'},{children:[{children:[].concat.apply([],[{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'},c('RelayQL').__frag(r),{children:[{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{isAbstract:true},name:'IdFragment',type:'Node'}]),fieldName:'node',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id',isAbstract:true,isRequisite:true},type:'Message'},{fieldName:'cursor',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],fieldName:'edges',kind:'Field',metadata:{canHaveSubselections:true,isPlural:true},type:'MessagesOfThreadEdge'},{children:[{fieldName:'has_next_page',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'Boolean'},{fieldName:'has_previous_page',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'Boolean'}],fieldName:'page_info',kind:'Field',metadata:{canHaveSubselections:true,isGenerated:true,isRequisite:true},type:'PageInfo'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{},name:'MontageSpotlightViewer_react_MessagesRelayQL',type:'MessagesOfThreadConnection'};}(p);},message:function q(){return p;}}});}),null);
__d('MontageState',[],(function a(b,c,d,e,f,g){'use strict';var h={needsUpdating:{}};f.exports=h;}),null);
__d('MontageStore',['MontageDispatcher','MontageShouldUpdateReducer','MontageState','FluxReduceStore'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=[].concat(Object.values(c('MontageShouldUpdateReducer')));h=babelHelpers.inherits(k,c('FluxReduceStore'));i=h&&h.prototype;k.prototype.getInitialState=function(){return c('MontageState');};k.prototype.reduce=function(l,m){return j.reduce(function(n,o){return o(n,m);},l);};function k(){h.apply(this,arguments);}f.exports=new k(c('MontageDispatcher'));}),null);
__d('MessengerMarkReadMutation',['RelayMutation','RelayQL'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('RelayMutation'));i=h&&h.prototype;j.prototype.getMutation=function(){return function(){return {calls:[{kind:'Call',metadata:{},name:'message_thread_update_read_state',value:{kind:'CallVariable',callVariableName:'input'}}],children:[{fieldName:'client_mutation_id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],kind:'Mutation',metadata:{inputType:'MessageThreadUpdateReadStateData!'},name:'MessengerMarkReadMutation',responseType:'MessageThreadUpdateReadStateResponsePayload'};}();};j.prototype.getVariables=function(){return {actor_id:this.props.actorID,thread_id:this.props.threadID,update_type:'mark_read'};};j.prototype.getFatQuery=function(){return function(){return {children:[{children:[{fieldName:'unread_count',kind:'Field',metadata:{},type:'Int'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],fieldName:'thread',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id'},type:'MessageThread'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{},name:'MessengerMarkReadMutationRelayQL',type:'MessageThreadUpdateReadStateResponsePayload'};}();};j.prototype.getConfigs=function(){return [{type:'FIELDS_CHANGE',fieldIDs:{thread:this.props.threadID}}];};j.prototype.getOptimisticResponse=function(){return {thread:{id:this.props.threadID,unread_count:0}};};function j(){h.apply(this,arguments);}f.exports=j;}),null);
__d('MontageThumbnail.react',['cx','CssBackgroundImage.react','MessengerTextWithEntities.react','React','Relay','RelayQL'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes,l=28,m=21;i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;n.prototype.render=function(){return c('React').createElement('div',{className:"_4bj3"},this.getFirstImage(),this.renderUnreadBadge());};n.prototype.renderUnreadBadge=function(){return this.props.unread?c('React').createElement('div',{className:"_4bj5",style:{backgroundColor:this.props.customColor}}):null;};n.prototype.getFirstImage=function(){var o=this.props.message;if(!o)return null;if(o.sticker)return this.getImageElement(o.sticker.image);if(o.blob_attachments[0]){var p=o.blob_attachments[0],q=p.image||p.videoImage||p.mediaImage;if(q)return this.getImageElement(q);}if(o.message.text)return c('React').createElement(c('MessengerTextWithEntities.react'),{className:"_4bj6 _4bj9",customSize:true,renderEmoji:true,style:{height:l,width:m},text:o.message.text});return null;};n.prototype.getImageElement=function(o){return c('React').createElement(c('CssBackgroundImage.react'),{className:"_4bj6",height:l,imageURI:o.uri,width:m});};function n(){i.apply(this,arguments);}n.propTypes={customColor:k.string,message:k.object.isRequired,unread:k.bool.isRequired};f.exports=c('Relay').createContainer(n,{fragments:{message:function o(p){return function(q,r,s,t,u,v,w,x){return {children:[{children:[{fieldName:'text',kind:'Field',metadata:{},type:'String'}],fieldName:'message',kind:'Field',metadata:{canHaveSubselections:true},type:'TextWithEntities'},{children:[{calls:[{kind:'Call',metadata:{type:'Int'},name:'height',value:c('RelayQL').__var(q)},{kind:'Call',metadata:{type:'Int'},name:'width',value:c('RelayQL').__var(r)}],children:[{fieldName:'uri',kind:'Field',metadata:{},type:'Url'}],fieldName:'image',kind:'Field',metadata:{canHaveSubselections:true},type:'Image'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],fieldName:'sticker',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id'},type:'Sticker'},{children:[{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'},{children:[{alias:'mediaImage',calls:[{kind:'Call',metadata:{type:'Int'},name:'height',value:c('RelayQL').__var(s)},{kind:'Call',metadata:{type:'Int'},name:'width',value:c('RelayQL').__var(t)}],children:[{fieldName:'uri',kind:'Field',metadata:{},type:'Url'}],fieldName:'image',kind:'Field',metadata:{canHaveSubselections:true},type:'Image'},{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'},{children:[{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{isAbstract:true},name:'IdFragment',type:'Node'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{isAbstract:true},name:'Media',type:'Media'},{children:[{alias:'videoImage',calls:[{kind:'Call',metadata:{type:'Int'},name:'height',value:c('RelayQL').__var(u)},{kind:'Call',metadata:{type:'Int'},name:'width',value:c('RelayQL').__var(v)}],children:[{fieldName:'uri',kind:'Field',metadata:{},type:'Url'}],fieldName:'image',kind:'Field',metadata:{canHaveSubselections:true},type:'Image'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{},name:'MessageVideo',type:'MessageVideo'},{children:[{calls:[{kind:'Call',metadata:{type:'Int'},name:'height',value:c('RelayQL').__var(w)},{kind:'Call',metadata:{type:'Int'},name:'width',value:c('RelayQL').__var(x)}],children:[{fieldName:'uri',kind:'Field',metadata:{},type:'Url'}],fieldName:'image',kind:'Field',metadata:{canHaveSubselections:true},type:'Image'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{},name:'MessageImage',type:'MessageImage'},{children:[{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{isAbstract:true},name:'IdFragment',type:'Node'}],fieldName:'blob_attachments',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id',isAbstract:true,isPlural:true},type:'MessageBlobAttachment'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{},name:'MontageThumbnail_react_MessageRelayQL',type:'UserMessage'};}(l,m,l,m,l,m,l,m);}}});}),null);
__d('MontageViewerSingleThread.react',['MontageSpotlightViewer.react','React','Relay','RelayQL'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').Component);i=h&&h.prototype;function k(){var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=i.constructor).call.apply(l,[this].concat(o)),this.$MontageViewerSingleThread1=function(q){var r=this.props.montageThread.messages.count,s=this.props.relay.variables.count;if(s<r){var t=Math.min(s+q,r);this.props.relay.setVariables({count:t});}}.bind(this),m;}k.prototype.render=function(){return this.props.open?c('React').createElement(c('MontageSpotlightViewer.react'),{entryPoint:'reply_context',initialUnreadCount:this.props.unreadCount,loadMore:this.$MontageViewerSingleThread1,onHide:this.props.onHide,messages:this.props.montageThread.messages}):null;};k.propTypes={open:j.bool.isRequired,onHide:j.func.isRequired,montageThread:j.object.isRequired,relay:j.object.isRequired,unreadCount:j.number.isRequired};f.exports=c('Relay').createContainer(k,{initialVariables:{count:100},fragments:{montageThread:function l(){return function(m){return {children:[{calls:[{kind:'Call',metadata:{type:'Int'},name:'last',value:{kind:'CallVariable',callVariableName:'count'}}],children:[].concat.apply([],[c('RelayQL').__frag(m)]),fieldName:'messages',kind:'Field',metadata:{canHaveSubselections:true,isConnection:true},type:'MessagesOfThreadConnection'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{},name:'MontageViewerSingleThread_react_MontageThreadRelayQL',type:'MessageThread'};}(c('MontageSpotlightViewer.react').getFragment('messages'));}}});}),null);
__d('MontageThreadView.react',['cssVar','cx','fbt','CurrentUser','MessengerEnvironment','MessengerLogo.react','MessengerMarkReadMutation','MontageThumbnail.react','MontageViewerSingleThread.react','React','Relay','RelayQL','Timestamp.react','convertMIGColorToFIGColor','idx'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l,m=c('React').PropTypes;k=babelHelpers.inherits(n,c('React').PureComponent);l=k&&k.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=l.constructor).call.apply(o,[this].concat(r)),this.state={showMontage:false},this.$MontageThreadView1=function(){this.setState({showMontage:true});}.bind(this),this.$MontageThreadView2=function(){this.setState({showMontage:false});this.props.relay.commitUpdate(new (c('MessengerMarkReadMutation'))({threadID:this.props.threadMessages.montage_thread.id,actorID:c('CurrentUser').getID()}));}.bind(this),p;}n.prototype.componentDidMount=function(){if(this.props.threadMessages)this.props.onResize&&this.props.onResize();var o=this.getMontageThreadID();if(o)this.props.setThreadID&&this.props.setThreadID(o);};n.prototype.componentDidUpdate=function(o){if(o.threadMessages!==this.props.threadMessages)this.props.onResize&&this.props.onResize();};n.prototype.render=function(){var o=this.getFirstMontageMessage();if(!o)return null;var p=this.getCustomColor(),q=this.getUnread();return c('React').createElement('a',{className:"_5no5",href:'#',onClick:this.$MontageThreadView1,role:'button'},c('React').createElement(c('MontageThumbnail.react'),{customColor:p,message:o,unread:q}),c('React').createElement('div',{className:"_1sui"},this.renderHeader(q,p),c('React').createElement('span',{className:"_1suk"},c('React').createElement(c('Timestamp.react'),{minimize:true,time:this.getTimestamp()}))),this.renderLogo(),this.renderModal());};n.prototype.renderModal=function(){return this.state.showMontage?c('React').createElement(c('MontageViewerSingleThread.react'),{onHide:this.$MontageThreadView2,open:this.state.showMontage,montageThread:this.props.threadMessages.montage_thread,unreadCount:this.props.threadMessages.montage_thread.unread_count}):null;};n.prototype.renderLogo=function(){return c('MessengerEnvironment').messengerui?null:c('React').createElement(c('MessengerLogo.react'),{color:"rgba(0, 0, 0, .3)",size:'17px'});};n.prototype.renderHeader=function(o,p){return o?c('React').createElement('h1',{className:"_1suj",style:{color:p}},j._("Watch {person_with_montage}'s day",[j.param('person_with_montage',this.getAuthorName())])):null;};n.prototype.getAuthorName=function(){var o;return (o=this.props)!=null?(o=o.threadMessages)!=null?(o=o.montage_thread)!=null?(o=o.montage_author)!=null?o.short_name:o:o:o:o;};n.prototype.getFirstMontageMessage=function(){var o;return (o=this.props)!=null?(o=o.threadMessages)!=null?(o=o.montage_thread)!=null?(o=o.messages)!=null?(o=o.edges)!=null?(o=o[0])!=null?o.node:o:o:o:o:o:o;};n.prototype.getTimestamp=function(){var o=this.getFirstMontageMessage();return o&&o.timestamp;};n.prototype.getCustomColor=function(){var o,p=(o=this.props)!=null?(o=o.threadMessages)!=null?(o=o.customization_info)!=null?o.outgoing_bubble_color:o:o:o,q=void 0;if(!p){q="#0084ff";}else q='#'+p.substring(2);return c('convertMIGColorToFIGColor')(q);};n.prototype.getUnread=function(){var o;return !!((o=this.props)!=null?(o=o.threadMessages)!=null?(o=o.montage_thread)!=null?o.unread_count:o:o:o);};n.prototype.getMontageThreadID=function(){var o;return (o=this.props)!=null?(o=o.threadMessages)!=null?(o=o.montage_thread)!=null?(o=o.thread_key)!=null?o.thread_fbid:o:o:o:o;};n.propTypes={onResize:m.func,threadMessages:m.object.isRequired};f.exports=c('Relay').createContainer(n,{fragments:{threadMessages:function o(p){return function(q,r){return {children:[{children:[{fieldName:'outgoing_bubble_color',kind:'Field',metadata:{},type:'Color'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],fieldName:'customization_info',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id'},type:'MessageThreadCustomization'},{children:[].concat.apply([],[{fieldName:'id',kind:'Field',metadata:{isRequisite:true},type:'ID'},{children:[{fieldName:'thread_fbid',kind:'Field',metadata:{},type:'String'}],fieldName:'thread_key',kind:'Field',metadata:{canHaveSubselections:true},type:'MessageThreadKey'},{calls:[{kind:'Call',metadata:{type:'Int'},name:'last',value:{kind:'CallValue',callValue:1}}],children:[{children:[{children:[].concat.apply([],[{fieldName:'timestamp',kind:'Field',metadata:{},type:'Time'},{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'},c('RelayQL').__frag(r),{children:[{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{isAbstract:true},name:'IdFragment',type:'Node'}]),fieldName:'node',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id',isAbstract:true,isRequisite:true},type:'Message'},{fieldName:'cursor',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],fieldName:'edges',kind:'Field',metadata:{canHaveSubselections:true,isPlural:true},type:'MessagesOfThreadEdge'},{children:[{fieldName:'has_next_page',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'Boolean'},{fieldName:'has_previous_page',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'Boolean'}],fieldName:'page_info',kind:'Field',metadata:{canHaveSubselections:true,isGenerated:true,isRequisite:true},type:'PageInfo'}],fieldName:'messages',kind:'Field',metadata:{canHaveSubselections:true,isConnection:true},type:'MessagesOfThreadConnection'},{children:[{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},{fieldName:'__typename',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'String'},{children:[{fieldName:'short_name',kind:'Field',metadata:{},type:'String'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{},name:'User',type:'User'}],fieldName:'montage_author',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id',isAbstract:true},type:'Actor'},{fieldName:'unread_count',kind:'Field',metadata:{},type:'Int'},c('RelayQL').__frag(q)]),fieldName:'montage_thread',kind:'Field',metadata:{canHaveSubselections:true,inferredRootCallName:'node',inferredPrimaryKey:'id'},type:'MessageThread'},{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'}],id:c('RelayQL').__id(),kind:'Fragment',metadata:{},name:'MontageThreadView_react_ThreadMessagesRelayQL',type:'MessageThread'};}(c('MontageViewerSingleThread.react').getFragment('montageThread'),c('MontageThumbnail.react').getFragment('message'));}}});}),null);
__d('MontageThreadViewRoute',['RelayQL','RelayRoute'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('RelayRoute'));i=h&&h.prototype;function j(){h.apply(this,arguments);}j.routeName='MontageThreadViewRoute';j.queries={threadMessages:function k(l){return function(m){return {calls:[{kind:'Call',metadata:{type:'ID!'},name:'id',value:{kind:'CallVariable',callVariableName:'threadFBID'}}],children:[].concat.apply([],[{fieldName:'id',kind:'Field',metadata:{isGenerated:true,isRequisite:true},type:'ID'},c('RelayQL').__frag(m)]),fieldName:'message_thread',kind:'Query',metadata:{identifyingArgName:'id',identifyingArgType:'ID!'},name:'MontageThreadViewRoute',type:'MessageThread'};}(l.getFragment('threadMessages'));}};j.paramDefinitions={threadFBID:{type:'ID',required:true}};f.exports=j;}),null);
__d('MontageThreadViewContainerImpl.react',['FluxContainer','MercuryIDs','MontageActions','MontageStore','MontageThreadView.react','MontageThreadViewRoute','React','Relay'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('Relay').RootContainer,k=c('React').PropTypes;h=babelHelpers.inherits(l,c('React').PureComponent);i=h&&h.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=i.constructor).call.apply(m,[this].concat(p)),this.threadIDToMontageThreadID={},this.$MontageThreadViewContainer1=function(r){var s=c('MercuryIDs').getThreadFBIDFromThreadID(this.props.threadID);if(!s)return null;return c('React').createElement(c('MontageThreadView.react'),babelHelpers['extends']({},r,{onResize:this.props.onResize,setThreadID:this.$MontageThreadViewContainer4}));}.bind(this),this.$MontageThreadViewContainer3=function(r){if(r&&r.stale)return;var s=c('MercuryIDs').getThreadFBIDFromThreadID(this.props.threadID),t=this.threadIDToMontageThreadID[s];if(this.state.needsUpdating[s])c('MontageActions').hasUpdated(s);if(this.state.needsUpdating[s])c('MontageActions').hasUpdated(t);}.bind(this),this.$MontageThreadViewContainer4=function(r){var s=c('MercuryIDs').getThreadFBIDFromThreadID(this.props.threadID);this.threadIDToMontageThreadID[s]=r;}.bind(this),n;}l.getStores=function(){return [c('MontageStore')];};l.calculateState=function(){return {needsUpdating:c('MontageStore').getState().needsUpdating};};l.prototype.render=function(){var m=this.props.threadID,n=c('MercuryIDs').getThreadFBIDFromThreadID(m);if(!n)return null;return c('React').createElement(j,{Component:c('MontageThreadView.react'),route:new (c('MontageThreadViewRoute'))({threadFBID:n}),renderFetched:this.$MontageThreadViewContainer1,forceFetch:this.$MontageThreadViewContainer2(n),onReadyStateChange:this.$MontageThreadViewContainer3});};l.prototype.$MontageThreadViewContainer2=function(m){return !!(this.state.needsUpdating[m]||this.state.needsUpdating[this.threadIDToMontageThreadID[m]]);};l.propTypes={onResize:k.func,threadID:k.string.isRequired};f.exports=c('FluxContainer').create(l);}),null);